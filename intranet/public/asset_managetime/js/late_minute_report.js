function s2ab(e){for(var t=new ArrayBuffer(e.length),s=new Uint8Array(t),a=0;a<e.length;a++)s[a]=255&e.charCodeAt(a);return t}$(function(){var e=$(".ct-text-select option:selected").text();e&&$(".select_team .select2-selection--single").text(e.trim()),$(".select_team .select-search ").on("change",function(){var e=$(".ct-text-select option:selected").text();$(".select_team .select2-selection--single").text(e.trim())})}),$("body").on("click",".btn-export",function(e){e.preventDefault();var t=this;$(this).addClass("disabled"),$(this).find(".fa-refresh").removeClass("hidden");var s=getCheckItem(sessionKeys);$.ajax({url:url_export,type:"POST",dataType:"json",data:{_token:_token,arrItem:s},success:function(e){if(e.status){var s=e.data,a=[];if(!s.length)return alert("Không có nhân viên"),$(t).find(".fa-refresh").addClass("hidden"),void $(t).removeClass("disabled");var n=XLSX.utils.book_new();n.SheetNames.push("Sheet 1"),a.push(e.heading);for(var r in s)a.push([s[r].employee_code,s[r].employee_name,s[r].team_name,s[r].count_late_minute,s[r].sum_late_minute,s[r].total_fine_money]);var i=XLSX.utils.json_to_sheet(a,{skipHeader:!0}),l=[{wch:15},{wch:20},{wch:20}];i["!cols"]=l,n.Sheets["Sheet 1"]=i;var o=XLSX.write(n,{bookType:"xlsx",type:"binary"});saveAs(new Blob([s2ab(o)],{type:"application/octet-stream"}),"minute_late_report.xlsx"),removeCheckItem(sessionKeys),$(t).find(".fa-refresh").addClass("hidden"),$(t).removeClass("disabled")}else alert(e.message),$(t).find(".fa-refresh").addClass("hidden"),$(t).removeClass("disabled")},error:function(e){}})});