function loadData(e){null!=xhr&&xhr.abort();var t=$("#start_date").val(),a=$("#end_date").val(),i=$("#timekeeping_table_active").val(),d=$buttonFilter.find(".fa-refresh");d.removeClass("hidden");var l=$("select[name=limit] option:selected").data("value");$("html, body").animate({scrollTop:$("body").offset().top},"slow"),xhr=$.ajax({type:"GET",url:urlFilter,timeout:3e4,data:{startDateFilter:t,endDateFilter:a,teamId:a,timekeepingTableIdActive:i,limit:l,page:e},success:function(t){$("#filter_data").html(t),$buttonLast.find("a").attr("data-page",totalPage),$inputPager.val(e);var a=parseInt(e)+1,i=parseInt(e)-1;$buttonPrev.removeClass("disabled"),$buttonNext.removeClass("disabled"),$buttonLast.removeClass("disabled"),$buttonFirst.removeClass("disabled"),$buttonNext.find("a").attr("data-page",a),$buttonPrev.find("a").attr("data-page",i),totalPage<a&&$buttonNext.addClass("disabled"),0==i&&$buttonPrev.addClass("disabled"),1==e&&$buttonFirst.addClass("disabled"),e==totalPage&&$buttonLast.addClass("disabled"),$(".data-pager-info span").html(pagerInfo),setHeightBody(".content-wrapper",50)},complete:function(){d.addClass("hidden");var e=$("#timekeeping_table_active").val();$(".managetime-menu li a").each(function(){$(this).attr("data-timekeeping-table-id")==e&&($(".timekeeping-time-to-time a.active").removeClass("active"),$(this).addClass("active"))})}})}function setHeightBody(e,t){$(e).css("min-height",$(window).height()-$(".main-footer").outerHeight()-t)}function setFixedHeaderTimekeeping(){setTimeout(function(){var e=$("#_me_table").height();if($(window).height()<e+200){var t=[];$("#_me_tbl_left thead tr:eq(0) th").each(function(e){t[e]=$(this).width(),$(this).css("width",t[e]),$(this).closest("table").find("tbody tr:eq(1) td:eq("+e+")").css("width",t[e])});var a=[];$("#_me_table thead tr:eq(0) th").each(function(e){a[e]=$(this).width(),$(this).css("min-width",a[e]),$(this).closest("table").find("tbody tr:eq(1) td:eq("+e+")").css("width",a[e])});var i=$("#_me_table thead").height(),d=$("#top_fixed_head"),l=$("#me_table_container").clone().removeAttr("id"),n=l.find("#_me_tbl_left"),s=l.find("#_me_table");n.find("tbody tr:not(:first)").remove(),n.find("tbody tr .select2").remove(),s.find("tbody tr:not(:first)").remove(),s.find("tbody tr .select2").remove(),l.appendTo(d),l.find("tr select:not(.compare)").select2(),$("#me_table_container").find("table").each(function(){$(this).find("tbody tr:first").remove()}),$("#me_table_container").find("table").css("cssText","margin-top: "+-i+"px!important;"),$("._me_table_responsive").on("scroll",function(){var e=$(this).scrollLeft();$("._me_table_responsive").scrollLeft(e)});var o=d.offset().top,r=d.height();$(window).scroll(function(){var e=$(window).scrollTop();e>o?($("#top_fixed_head").addClass("top-fixed").css("top",e-$("._me_review_page").offset().top-5),$("#me_table_container").css("margin-top",r)):($("#top_fixed_head").removeClass("top-fixed").css("top","auto"),$("#me_table_container").css("margin-top",0))})}},200)}function validateRow(e){var t=!0;return e.find("td .edit-field").each(function(){var e=$(this),a=e.val().trim();a&&$.isNumeric(a)||(e.css("border-color","red"),t=!1)}),t}function setValue(e,t){e.find("td").each(function(){var e=$(this);if(1===t)e.find(".edit-field").each(function(){var t=$(this).data("field"),a=e.find(".edit-field-hidden[data-field="+t+"]").val();a||(a=0);var i=jQuery.inArray(t,["total_number_late_in","total_number_early_out"])!==-1?0:2;$(this).val(rounding(a,i))});else{var a=0;e.find(".edit-field").each(function(){var t=$(this).data("field"),i=$(this).val();i||(i=0),e.find(".edit-field-hidden[data-field="+t+"]").val($(this).val()),a+=parseFloat(i)});var i=e.find(".result-field");i.hasClass("is-int")?i.text(rounding(a,0)):i.text(rounding(a,2))}});var a=e.find(".edit-field-hidden[data-field=total_official_ot_weekdays]").val(),i=e.find(".edit-field-hidden[data-field=total_official_ot_weekends]").val(),d=e.find(".edit-field-hidden[data-field=total_official_ot_holidays]").val(),l=parseFloat(a)+parseFloat(i)+parseFloat(d);l=parseFloat(l)||0,e.find("span[data-field=total_ot_official]").text(rounding(l,2));var n=e.find(".edit-field-hidden[data-field=total_trial_ot_weekdays]").val(),s=e.find(".edit-field-hidden[data-field=total_trial_ot_weekends]").val(),o=e.find(".edit-field-hidden[data-field=total_trial_ot_holidays]").val(),r=parseFloat(n)+parseFloat(s)+parseFloat(o);r=parseFloat(r)||0,e.find("span[data-field=total_ot_trial]").text(rounding(r,2));var f=e.find(".edit-field-hidden[data-field=total_official_working_days]").val(),c=e.find(".edit-field-hidden[data-field=total_official_business_trip]").val(),h=e.find(".edit-field-hidden[data-field=total_official_leave_day_has_salary]").val(),v=e.find(".edit-field-hidden[data-field=total_official_supplement]").val(),_=e.find(".edit-field-hidden[data-field=total_official_holiay]").val(),u=e.find(".edit-field-hidden[data-field=number_com_off]").val(),p=parseFloat(f)+parseFloat(c)+parseFloat(h)+parseFloat(v)+parseFloat(_)-u;p=parseFloat(p)||0,e.find("span[data-field=total_working_official_salary]").text(rounding(p,2));var m=e.find(".edit-field-hidden[data-field=total_trial_working_days]").val(),b=e.find(".edit-field-hidden[data-field=total_trial_business_trip]").val(),g=e.find(".edit-field-hidden[data-field=total_trial_leave_day_has_salary]").val(),C=e.find(".edit-field-hidden[data-field=total_trial_supplement]").val(),w=e.find(".edit-field-hidden[data-field=total_trial_holiay]").val();b=isNaN(b)?0:b,g=isNaN(g)?0:g,C=isNaN(C)?0:C,w=isNaN(w)?0:w;var y=e.find(".edit-field-hidden[data-field=number_com_tri]").val(),x=parseFloat(m)+parseFloat(b)+parseFloat(g)+parseFloat(C)+parseFloat(w)-y;x=parseFloat(x)||0,e.find("span[data-field=total_working_trial_salary]").text(rounding(x,2))}$(function(){$("#datetimepicker-start-date").datepicker({autoclose:!0,format:"dd-mm-yyyy"}),$("#datetimepicker-end-date").datepicker({autoclose:!0,format:"dd-mm-yyyy"})});var xhr=null;$(".btn-edit-row").on("click",function(){var e=$(this),t=e.closest("tr");t.find("td .edit-field").css("border-color","#ccc"),t.find(".edit-field").removeClass("hidden"),t.find(".result-field").addClass("hidden"),t.find(".btn-save-row").removeClass("hidden"),t.find(".btn-cancel-row").removeClass("hidden"),e.addClass("hidden"),setValue(t,1),fixHeightTr()}),$(".btn-cancel-row").on("click",function(){var e=$(this),t=e.closest("tr");t.find(".edit-field").addClass("hidden"),t.find(".result-field").removeClass("hidden"),t.find(".btn-save-row").addClass("hidden"),t.find(".btn-edit-row").removeClass("hidden"),e.addClass("hidden"),fixHeightTr()}),$(".btn-save-row").on("click",function(){var e=$(this),t=e.closest("tr");if(!validateRow(t))return!1;e.prop("disabled",!0),e.find("i.fa-refresh").removeClass("hidden");var a={};t.find("td .edit-field").each(function(){var e=$(this).data("field");a[e]=$(this).val()}),$.ajax({type:"post",dataType:"json",data:{_token:token,data:a,empId:t.data("emp"),tableId:tableId},url:e.data("url"),success:function(){t.find(".edit-field").addClass("hidden"),t.find(".result-field").removeClass("hidden"),t.find(".btn-save-row").addClass("hidden"),t.find(".btn-cancel-row").addClass("hidden"),t.find(".btn-edit-row").removeClass("hidden"),setValue(t,2),fixHeightTr()},complete:function(){e.prop("disabled",!1),e.find("i.fa-refresh").addClass("hidden")}})}),$("input.edit-field").focus(function(){$(this).parent().find(".note").removeClass("hidden"),$(this).parent().find(".arrow-left").removeClass("hidden")}),$("input.edit-field").blur(function(){$(this).parent().find(".note").addClass("hidden"),$(this).parent().find(".arrow-left").addClass("hidden")}),$(document).on("click",".text-label",function(){var e=$(this).closest("td");e.find(".arrow-up").removeClass("hidden"),e.find(".text-label").addClass("hidden"),e.find(".filter-grid").removeClass("hidden"),e.find(".filter-group").addClass("filter-focus"),e.find("input.filter-grid").focus()}),$(document).mouseup(function(e){var t=$(".filter-focus");if(!t.is(e.target)&&0===t.has(e.target).length){var a=t.closest("td"),i=a.find("input.filter-grid").val(),d=a.find("select.filter-grid").val();i?a.find(".text-label").val(d+" "+i):a.find(".text-label").val(""),a.find(".arrow-up").addClass("hidden"),a.find(".text-label").removeClass("hidden"),a.find(".filter-grid").addClass("hidden"),a.find(".filter-group").removeClass("filter-focus")}}),$(document).on("change","select.filter-grid",function(){$(this).parent().find("input.filter-grid").focus()});