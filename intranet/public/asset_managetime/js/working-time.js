!function(e){if(RKfuncion.select2.init(),e("#working_time_form").length>0&&e("#working_time_form").validate({ignore:[],rules:{approver_id:{required:!0},from_month:{required:!0},to_month:{required:!0,greaterThan:"from_month"},start_time1:{required:!0},end_time1:{required:!0,greaterThan:"start_time1"},start_time2:{required:!0},end_time2:{required:!0,greaterThan:"start_time2"},reason:{required:!0}},messages:{approver_id:{required:textRequiredField},from_month:{required:textRequiredField,validDate:!0},to_month:{required:textRequiredField,greaterThan:textGreaterThanFromMonth,validDate:!0},start_time1:{required:textRequiredField,validDate:!0},end_time1:{required:textRequiredField,greaterThan:textGreaterThanStartTime,validDate:!0},start_time2:{required:textRequiredField,validDate:!0},end_time2:{required:textRequiredField,greaterThan:textGreaterThanStartTime,validDate:!0},reason:{required:textRequiredField}},errorPlacement:function(e,t){e.appendTo(t.closest(".form-group"))}}),e(".select-tooltip").each(function(){if("undefined"!=typeof e(this).data("toggle")){var t=e(this).next(".select2-container");t.data("toggle","tooltip").attr("title",e(this).attr("title")).tooltip()}}),e("#btn_working_time_submit").click(function(){var t=e(this).closest("form"),a=e(this);if(t.valid()){if(4===t.find(".input-group-time").length){var i=[];if(t.find(".input-group-time").each(function(t){var a=e(this).find("input");i.push(moment(a.val(),a.data("format")))}),4!==i.length)return bootbox.alert({className:"modal-danger",message:textInvalidTotalWorkingTime}),a.prop("disabled",!1),!1;var r=i[1].diff(i[0])/36e5,o=i[3].diff(i[2])/36e5;if(r<MIN_HOUR_MOR||o<MIN_HOUR_AFT)return bootbox.alert({className:"modal-danger",message:textInvalidShiftTime}),a.prop("disabled",!1),!1;var n=r+o;if(n!=TOTAL_TIME)return bootbox.alert({className:"modal-danger",message:textInvalidTotalWorkingTime}),a.prop("disabled",!1),!1}bootbox.confirm({className:"modal-warning",message:a.data("noti"),buttons:{cancel:{label:confirmNo},confirm:{label:confirmYes}},callback:function(e){e?t.submit():a.prop("disabled",!1)}})}return!1}),e("button.status-submit").click(function(){var t=e(this),a=t.data("url"),i=t.data("status"),r=t.data("id");if("undefined"!=typeof r&&r)var o=[r];else{var o=[];e(".working-time-tbl tbody .check-item:checked").each(function(){i!=e(this).data("status")&&o.push(e(this).val())})}return 0===o.length?(bootbox.alert({className:"modal-danger",message:textRequiredItem,buttons:{ok:{label:confirmYes}}}),!1):!(!a||!i)&&(t.prop("disabled",!0),void bootbox.confirm({className:"modal-warning",message:t.data("noti"),buttons:{cancel:{label:confirmNo},confirm:{label:confirmYes}},callback:function(e){if(e){var r=document.createElement("form");r.setAttribute("method","post"),r.setAttribute("action",a);var n={ids:o.join(","),status:i,_token:siteConfigGlobal.token};for(var d in n){var m=document.createElement("input");m.setAttribute("type","hidden"),m.setAttribute("name",d),m.setAttribute("value",n[d]),r.appendChild(m)}document.body.appendChild(r),r.submit(),r.remove()}t.prop("disabled",!1)}}))}),e("#btn_time_modal_reject").click(function(){var t=e("#working_time_form");if(t.length>0){if(!t.valid())return!1}else{var a=e(this).data("status"),i=[];if(e(".working-time-tbl tbody .check-item:checked").each(function(){e(this).data("status")!=a&&i.push(e(this).val())}),i.length<1)return bootbox.alert({className:"modal-danger",message:textItemNotValid,buttons:{ok:{label:confirmYes}}}),!1;e("#wk_time_modal_reject").find('input[name="ids"]').val(i.join(","))}e("#wk_time_modal_reject").modal("show")}),"undefined"!=typeof jQuery.validator&&(jQuery.validator.addMethod("validDate",function(t,a){if(t){var i=e(a).data("format"),r=moment(t,i);return this.optional(a)||r.isValid()}return!0},notValidDateFormat),jQuery.validator.addMethod("greaterThan",function(t,a,i){var r=e('[name="'+i+'"]');if(t&&r.val()){var o=e(a).data("format"),n=moment(t,o),d=moment(r.val(),o);return this.optional(a)||n>=d}return!0})),e(".input-group-month").each(function(){var t=e(this);t.find('input[type="text"]').is(":disabled")||t.datetimepicker({viewMode:"months",format:"MM-YYYY",useCurrent:!1})}),e(".input-group-month").on("dp.change",function(t){var a=e(this).find("input");"from_month"==a.attr("id")&&e("#to_month").closest(".input-group-month").data("DateTimePicker").minDate(t.date),"to_month"==a.attr("id")&&e("#from_month").closest(".input-group-month").data("DateTimePicker").maxDate(t.date)}),e(".input-group-time").each(function(){var t=e(this).find("input"),a=e(this).closest(".form-group").find("label i.fa");if(t.is(":disabled"))a.remove();else{var i=t.data("format"),r=t.data("range"),o={format:i,stepping:STEPING_MINUTE,useCurrent:!1};r?(o.minDate=moment(r[0],i).startOf("minute"),o.maxDate=moment(r[1],i).endOf("minute"),a.attr("title",r[0]+" - "+r[1]),a.tooltip()):a.remove(),e(this).datetimepicker(o)}}),e(".month-filter").datetimepicker({format:"MM-YYYY",useCurrent:!1,showClear:!0}),e(".date-filter").datetimepicker({format:"DD-MM-YY",useCurrent:!1,showClear:!0}),e(".short-content").shortedContent(),e(".check-all").change(function(){e(".check-item").prop("checked",e(this).is(":checked")),e(".status-btn").prop("disabled",0===e(".check-item:checked").length)}),e(".check-item").change(function(){e(".check-all").prop("checked",e(".check-item").length===e(".check-item:checked").length),e(".status-btn").prop("disabled",0===e(".check-item:checked").length)}),e("#working_time_log_form").length>0){for(var t={},a={},i=0;i<collectDates.length;i++){var r=collectDates[i];t["time_out["+r+"]"]={greaterThan:"time_in["+r+"]"},a["time_out["+r+"]"]={greaterThan:textGreaterThanStartTime}}e("#working_time_log_form").validate({rules:t,messages:a})}}(jQuery);