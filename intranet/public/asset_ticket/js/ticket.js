function getExtension(e){var t=e.split(".");return t[t.length-1]}function isImage(e){var t=getExtension(e);switch(t.toLowerCase()){case"jpg":case"gif":case"bmp":case"png":return!0}return!1}function checkTime(){var e=$("#deadline").val().split("-"),t=e[2].split(" "),i=t[0]+"-"+e[1]+"-"+e[0]+" "+t[1];return!(Date.parse(i)/1e3+60<Math.floor(Date.now()/1e3)+7200)}function check(e){var t=$("#field"),i=t[0].files.length,n=t[0].files,r=!0,a=$("#leader_id").val();if(0==a.trim().length)return $("#leader-error").show(),r=!1;if(!checkTime())return $(".checkTime").show(),r=!1;if($(".checkTime").hide(),r=!0,i>0){for(var l=0;l<i;l++){if(n[l].size>1e6){var r=!1;$("#errorSize").html("File "+n[l].name+" dung lượng lớn hơn 1MB");break}if(!isImage(n[l].name)){var r=!1;$("#errorSize").html("File "+n[l].name+" không đúng định dạng ảnh");break}}return r}return!0}var pgurl=window.location.href.substr(window.location.href),url=$(".menu-ticket #set_menu").val();pgurl==url&&$(".menu-ticket #menu_all").addClass("active"),$(".menu-ticket li a").each(function(){$(this).attr("href")!=pgurl&&""!=$(this).attr("href")||$(this).addClass("active")}),$("#leader_id").val($("#team_id").select2().find(":selected").attr("data-leader"));var removetmp=[];$("#field").change(function(e){if($("input[type=file]").val(),$("#remove").val(""),$("#submit").prop("disabled",!1),$("#errorSize").html(""),$("#nameImage").html(""),check()){var t=($("input[type=file]").val().split("\\").pop(),$("#field").prop("files")),i=$.map(t,function(e){return e.name});i.forEach(function(e,t){var i='<span class="tag"><span class="close_file" data-id='+t+" >&times;</span>"+e+"</span>";$("#nameImage").append(i)})}}),$("#datetimepicker1").click(function(e){$("#submit").prop("disabled",!1)}),$(function(){$("#nameImage").on("click",".close_file",function(){removetmp.push(parseInt($(this).attr("data-id"))),$("#remove").val(removetmp),$("input[type=file]").val(""),$(this).parent("span").fadeOut(100)}),$("#content").wysihtml5({toolbar:{"font-styles":!0,emphasis:!0,lists:!0,html:!1,link:!1,image:!1,color:!1,blockquote:!0}}),$(".wysihtml5-sandbox").contents().find("body").on("keydown",function(){$("#content-error").hide(),setTimeout(function(){""==$("#content").val()&&$("#content-error").show()},500)}),$("#box_add").hide(),$("#box_chart").hide();var e=new Date,t=e.setMinutes(e.getMinutes()+121);$("#datetimepicker1").datetimepicker({allowInputToggle:!0,defaultDate:t,sideBySide:!0});var i={required:MESSAGE_REQUIRE,rangelength:MESSAGE_RANGE_LENGTH};$("#form-post-edit").validate({ignore:":hidden:not(textarea)",rules:{subject:{required:!0,rangelength:[1,255]},deadline:{required:!0},WysiHtmlField:{required:!0}},messages:{subject:{required:i.required,rangelength:i.rangelength},deadline:{required:i.required},content:{required:i.required}}})}),$("#btn_add").click(function(){$("#box_add").show(800),$("#ticket_list").hide(800)}),$("#close").click(function(){$("#box_add").hide(800),$("#btn_add").show(),$("#ticket_list").show(800)});