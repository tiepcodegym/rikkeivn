!function(e){function t(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}e(".search-datepicker").datetimepicker({viewMode:"months",format:"YYYY-MM",useCurrent:!1}).on("dp.change",function(){e(".btn-search-filter").trigger("click")}),e("body").on("click","td.col-actions .btn-edit-money",function(t){var n=e(this).closest("tr");n.find(".text, .btn-edit-money").addClass("hidden"),n.find(".btn-editing, .input").removeClass("hidden")}),e("body").on("click",".btn-money-cancel",function(){e(this).closest("tr").find(".text, .btn-edit-money").removeClass("hidden"),e(this).closest("tr").find(".btn-editing, .input").addClass("hidden")}),e("body").on("click","td.col-actions .btn-money-save",function(){var n=e(this),a=n.parents("tr"),i={};return a.find(".input").each(function(){i[e(this).attr("name")]=e(this).val()}),!a.find(".error-note").hasClass("error")&&void bootbox.confirm({message:textConfirm,className:"modal-default",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(s){s&&e.ajax({data:i,url:n.attr("data-action"),method:"POST",headers:{"X-CSRF-TOKEN":_token},success:function(n){a.find(".input, .btn-editing").addClass("hidden"),a.find(".text, .btn-edit-money").removeClass("hidden"),void 0!==n.data?(a.find("span.text_amount").html(t(n.data.amount)),a.find("span.text_note").text(n.data.note),a.find("span.text_status_amount").html(listStatus[n.data.status_amount]),n.data.status_amount===STATUS_PAID?a.css("background","#dddddd"):n.data.status_amount.toString().indexOf([STATUS_UNPAID,STATUS_UPDATE_MONEY])===-1&&a.css("background","#ffffff"),e("#display-sum-money").load(location.href+" #display-sum-money .table-grid-data")):RKExternal.notify(i.message,!1)},error:function(){RKExternal.notify("System error!",!1)}})}})}),e(document).on("keyup","tbody tr .input[name='amount']",function(n){if(e.inArray(n.keyCode,[38,40,37,39])===-1){var a=e(this),i=parseInt(a.val().replace(/[\D\s\._\-]+/g,""));isNaN(i)?i=0:i,a.val(function(){return 0===i?0:t(i)})}}),e("body").on("keyup","tbody tr input[name='note']",function(t){var n=e(this);n.closest("tr.row-edit-money").find(".error-note").removeClass("error").text(""),n.val().trim().length>MAX_TEXT?(n.parents("tr").find(".input").css("vertical-align","top"),n.parents("tr").find(".error-note").addClass("error").html(lengthMax)):(n.parents("tr").find(".input").css("vertical-align",""),n.parents("tr").find(".error-note").removeClass("error").html(""))}),e("#form_import_fines_money").validate({rules:{file:"required"},messages:{file:textRequired}});var n="fines_money_checked",a=RKSession.getRawItem(n);if(a){for(var i=0;i<a.length;i++)e('.table-check-list .check-item[value="'+a[i]+'"]').prop("checked",!0);e("#tbl_check_all").prop("checked",e(".table-check-list .check-item").length===e(".table-check-list .check-item:checked").length)}e(".check-all").click(function(){var t=e(e(this).data("list"));t.find(".check-item").prop("checked",e(this).is(":checked")).trigger("change")}),e("body").on("change",".check-item",function(){var t=e(this).closest(".checkbox-list").data("all"),a=e(t);if(a.prop("checked",e('[data-all="'+t+'"] .check-item').length===e('[data-all="'+t+'"] .check-item:checked').length),"#tbl_check_all"===t){var i=RKSession.getRawItem(n);if(e(this).is(":checked")){var s=e(this).val().split(", ").filter(function(e){return""!==e});i=e.merge(s,i)}else{var r=e(this).val().split(", ").filter(function(e){return""!==e});i=arrayDiff(r,i)}RKSession.setRawItem(n,i)}}),e(document).on("click touchstart",".btn-reset-filter",function(e){e.preventDefault(),RKSession.removeItem(n)}),e("#form_export_fines_money").submit(function(){var t=e(this),a=t.find(".error-mess");a.addClass("hidden");var i=t.find('[name="itemsChecked"]');i.val("");var s=t.find('button[type="submit"]'),r=RKSession.getRawItem(n);return 0===parseInt(t.find('[name="export_all"]:checked').val())&&r.length<1?(a.text(textNoneItemSelected).removeClass("hidden"),s.prop("disabled",!1),!1):(i.val(r.join(",")),void s.prop("disabled",!1))})}(jQuery);