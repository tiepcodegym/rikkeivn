function getUrlFilterProfile(){var t=urlAssetProfile;return t+="?asset_code="+$("#table_asset_profile .filter-asset_code").val(),t+="&asset_name="+$("#table_asset_profile .filter-asset_name").val(),t+="&category_name="+$("#table_asset_profile .filter-category_name").val(),t+="&state="+$("#table_asset_profile .filter-state").val(),t+="&allocation_confirm="+$("#table_asset_profile .filter-allocation_confirm").val(),t+="&employee_id="+$("#table_asset_profile .filter-employee_id").val()}var pageLength=20;$(document).ready(function(){$.fn.textWidth=function(t,e){return $.fn.textWidth.fakeEl||($.fn.textWidth.fakeEl=$("<span>").hide().appendTo(document.body)),$.fn.textWidth.fakeEl.text(t||this.val()||this.text()).css("font",e||this.css("font")),$.fn.textWidth.fakeEl.width()};var t=$("#table_asset_profile").DataTable({processing:!0,lengthChange:!1,bFilter:!1,serverSide:!0,ajax:urlAssetProfile,pageLength:pageLength,order:[[4,"desc"]],bDestroy:!0,ordering:!1,info:!0,autoWidth:!1,columnDefs:[{targets:0,searchable:!1,orderable:!1,render:function(t,e,a,s){return'<input type="checkbox" value="'+a.id+'" data-state="'+a.state_asset+'" '+(a.status_confirm==ALLOCATION_CONFIRM_NONE||arrAssetCheck.indexOf(a.state_asset)!==-1?"disabled":"")+">"}}],select:{style:"multi"},columns:[{data:"",name:""},{data:"",name:""},{data:"asset_code",name:"asset_code"},{data:"asset_name",name:"asset_name"},{data:"category_name",name:"category_name"},{data:"state",name:"state"},{data:"received_date",name:"received_date"},{data:"note",name:"note"},{data:"note_of_emp",name:"note_of_emp"},{data:"allocation_confirm",name:"allocation_confirm"},{data:"",name:""}],fnDrawCallback:function(){var e=t.page.info();$("#table_asset_profile tbody tr").each(function(t){$(this).find("td:nth-child(2)").not(".dataTables_empty").html(e.page*pageLength+t+1)})}});$("#table_asset_profile thead tr.row-filter select").change(function(){t.ajax.url(getUrlFilterProfile()).load()}),$("#table_asset_profile thead tr.row-filter input[type=text]").keyup(function(e){var a=e.keyCode||e.which;13===a&&t.ajax.url(getUrlFilterProfile()).load()})}),$("#table_asset_profile thead").append($("#table_asset_profile_2 thead").html()),$(document).on("click",".btn-allocation-confirm",function(t){t.preventDefault(),$("#asset_id_confirm").val($(this).val()),$("#modal_confirm").modal("show")});var listIds=[],listState=[];$("body").on("change","#table_asset_profile input[type=checkbox]",function(){if($(this).is(":checked")){var t=$(this).attr("data-state");$.inArray(t,listState)===-1&&listState.push(t),$.inArray($(this).val(),listIds)===-1&&listIds.push($(this).val())}else listIds.splice($.inArray($(this).val(),listIds),1),listState.splice($.inArray($(this).val(),listState),1)}),$("body").on("click",".btn-asset-profile",function(){var t=$(this);switch(t.val()){case typeHanding:textConfirm=confirmHandover;break;case typeLost:textConfirm=confirmLost;break;case typeBroken:textConfirm=confirmBroken}listIds.length?bootbox.confirm({message:textConfirm,buttons:{confirm:{label:confirmYes,className:"btn-success width-80"},cancel:{label:confirmNo,className:"btn-danger width-80 pull-left"}},className:"modal-default",callback:function(e){e&&$.ajax({url:urlConfirm,method:"POST",data:{listIds:listIds,listState:listState,type:t.val(),_token:_token,employeeId:$("#employee_id").val()},success:function(t){bootbox.confirm({message:"<h4>"+t.message+"</h4><br>"+(t.html?t.html:""),size:"large",backdrop:!0,className:"modal-default modal-bootbox",buttons:{confirm:{label:confirmYes,className:"btn-success width-80"},cancel:{label:confirmNo,className:"btn-danger width-80 pull-left hidden"}},callback:function(t){t&&location.reload()}}),$("#table_asset_profile input:checked").each(function(){var t=$(this).closest("tr.bt-item").attr("data-id");listIds.indexOf(t)!==-1&&$(this).closest('tr.bt-item input[type="checkbox"]').prop("disabled","true")})}})}}):bootbox.alert({message:validAsset,backdrop:!0,className:"modal-default modal-bootbox",buttons:{ok:{label:confirmYes,className:"btn btn-primary width-80"}}})}),$(document).on("change",".note_asset_profile",function(){var t=$(this).val(),e=$(this).closest("tr").find('input[type="checkbox"]').val();$.ajax({url:urlSaveNoteOfEmp,type:"post",dataType:"json",data:{note:t,assetId:e,_token:_token},success:function(t){t.status?bootbox.alert({message:t.message,backdrop:!0,className:"modal-success modal-bootbox"}):bootbox.alert({message:"Error system",backdrop:!0,className:"modal-default modal-bootbox"})},error:function(){data.status||bootbox.alert({message:"Error system",backdrop:!0,className:"modal-default modal-bootbox"})}})}),$(document).ajaxComplete(function(){$("textarea.note_asset_profile").hover(function(){const t=$(this).parent(".comment");$(this).textWidth()>=$(this).width()?t.addClass("dropdown"):t.removeClass("dropdown")}),$("textarea.note_asset_profile").on("keyup",function(t){const e=$(this).parent(".comment"),a=$(this).val();var s=!1;13===t.keyCode&&(s=!0),$(this).textWidth()>=$(this).width()||s?e.addClass("dropdown"):$(this).textWidth()<$(this).width()&&!s&&e.removeClass("dropdown"),""===a&&e.removeClass("dropdown"),e.find(".dropdown-content").find("textarea").val(a)})});