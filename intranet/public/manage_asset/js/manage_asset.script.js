function initCheckbox(){$('input[type="checkbox"].minimal, input[type="radio"].minimal').iCheck({checkboxClass:"icheckbox_flat-green",radioClass:"iradio_minimal-green"}),$('.report input[type="checkbox"].minimal, input[type="radio"].minimal').iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_minimal-blue"})}function s2ab(e){if("undefined"!=typeof ArrayBuffer){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),n=0;n!==e.length;++n)a[n]=255&e.charCodeAt(n);return t}for(var t=[],n=0;n!==e.length;++n)t[n]=255&e.charCodeAt(n);return t}$(function(){function e(e){var t=$("#confirm_asset_table"),a=t.attr("data-employee"),n=$(".btn-detail-inventory").attr("data-inventory"),o={};"undefined"!=typeof a&&(o={employeeId:a,inventoryId:n}),$.ajax({url:e,type:"GET",data:o,success:function(e){var a=e.data;if(a.length>0)for(var n=0;n<a.length;n++){var o=a[n],i=$("#confirm_asset_item").clone().removeAttr("id").removeClass("hidden"),r=n+1+(e.current_page-1)*e.per_page;i.find(".col-no").text(r),i.find(".col-code").text(o.asset_code),i.find(".col-name").text(o.asset_name),i.find(".col-confirm").attr("name","asset_ids["+o.id+"]").text(o.label),i.find(".col-note textarea").attr("name","employee_notes["+o.id+"]").val(o.employee_note),i.appendTo(t.find("tbody"))}1===e.current_page&&0===a.length?$("#confirm_asset_none_item").removeClass("hidden"):$("#confirm_asset_none_item").addClass("hidden")}})}function t(e,t,a){var n=$("#confirm_asset_table"),o=$("#confirm_asset_more"),i=n.attr("data-employee"),r={};"undefined"!=typeof i&&(r={employeeId:i}),$.ajax({url:e,type:"GET",data:r,success:function(e){var a=e.data,i=e.next_page_url;if(a.length>0)for(var r=0;r<a.length;r++){var s=a[r],l=$("#confirm_asset_item").clone().removeAttr("id").removeClass("hidden"),d=r+1+(e.current_page-1)*e.per_page;l.find(".col-no").text(d),l.find(".col-code").text(s.asset_code),l.find(".col-name").text(s.asset_name),l.find(".col-confirm input").attr("name","asset_ids["+s.id+"]").prop("checked",1===parseInt(s.allocation_confirm)).val(s.id),l.find(".col-note textarea").attr("name","employee_notes["+s.id+"]").val(s.employee_note),l.appendTo(n.find("tbody"))}1==e.current_page&&0==a.length?$("#confirm_asset_none_item").removeClass("hidden"):$("#confirm_asset_none_item").addClass("hidden"),o.find("a").attr("href",i),i?o.removeClass("hidden"):o.addClass("hidden"),"undefined"!=typeof t&&t()},error:function(e){"undefined"!=typeof a&&a(e)}})}selectSearchReload(),$(".select-search-multiple").select2(),$(".datetime-picker").datepicker({autoclose:!0,format:"dd-mm-yyyy",weekStart:1,todayHighlight:!0}),$(".filter-date").datepicker({autoclose:!0,format:"dd-mm-yyyy",weekStart:1,todayHighlight:!0}).on("changeDate",function(e){e.stopPropagation(),$(".btn-search-filter").trigger("click")}).on("keyup",function(e){e.stopPropagation(),13===e.keyCode&&$(".btn-search-filter").trigger("click")}).on("clearDate",function(e){e.stopPropagation(),$(".btn-search-filter").trigger("click")}),RKfuncion.select2.elementRemote($(".search-employee")),$(".btn-get-asset-approve").click(function(){var e=$(this).attr("state");$.ajax({url:urlAjaxGetAssetToApprove,type:"GET",data:{assetState:e},success:function(e){$("#form_get_asset_to_approve").html(e.html),$("#modal_get_asset_to_approve").modal("show")},complete:function(e){$('.asset-table input[type="checkbox"].minimal').iCheck({checkboxClass:"icheckbox_flat-green"}),$("#table-asset-approval").find(".no-result-grid").length<=0&&$(".asset-table").DataTable({paging:!0,lengthChange:!1,searching:!1,ordering:!1,info:!0,autoWidth:!1})}})}),$(".call-ajax-get-modal").click(function(){var e=$(this).attr("value");$.ajax({url:urlAjaxGetModalReport,type:"GET",data:{reportType:e},success:function(e){$("#modal_report").html(e.html),$("#modal_report").modal("show")},complete:function(){$('.report input[type="checkbox"].minimal, input[type="radio"].minimal').iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_minimal-blue"}),tableReport=$(".asset-table-report").DataTable({paging:!0,lengthChange:!1,searching:!1,ordering:!1,info:!0,autoWidth:!1,bDestroy:!0,columnDefs:[{targets:0,checkboxes:{selectRow:!0}}],select:{style:"multi"},order:[[1,"asc"]]})}})}),$(".btn-detail-inventory").click(function(t){t.preventDefault(),$("#confirm_asset_none_item").addClass("hidden"),$("#confirm_asset_table tbody tr:not(:first)").remove(),$("#confirm_asset_table").attr("data-employee",$(this).attr("data-employee")),$("#modal_inventory").modal("show");var a=$(this).closest("table").find(".detail-col").data("url");e(a)}),$("#btn_inventory").click(function(e){if(e.preventDefault(),$("#confirm_asset_table tbody tr").length>1)return void $("#modal_inventory").modal("show");var a=$(this),n=a.data("url");if("undefined"!=typeof n&&n&&!a.is(":disabled")){var o=a.find("i.fa-refresh");o.hasClass("hidden")&&(o.removeClass("hidden"),t(n,function(){$("#modal_inventory").modal("show");var e={};$("#confirm_asset_table tbody tr:not(.hidden)").each(function(){var t=$(this),a=t.find(".col-confirm input"),n=t.find(".col-note textarea");e[n.attr("name")]={required:function(){return!a.is(":checked")}}}),$("#profile_inventory_form").validate({rules:e}),o.addClass("hidden")},function(e){bootbox.alert({message:e.responseJSON,className:"modal-danger"}),o.addClass("hidden")}))}}),$("#confirm_asset_more a").click(function(e){e.preventDefault();var a=$(this).attr("href");if(a){var n=$(this).find("i");n.hasClass("hidden")&&(n.removeClass("hidden"),t(a,function(){n.addClass("hidden")}))}}),$("#btn_inventory_export").click(function(e){e.preventDefault();var t=$(this),a=t.find("i"),n=t.data("url"),o=t.data("id");a.hasClass("hidden")&&n&&o&&(t.prop("disabled",!0),a.removeClass("hidden"),$.ajax({type:"POST",url:n,data:{_token:siteConfigGlobal.token,inventory_id:o},success:function(e){var a=XLSX.utils.book_new(),n=e.sheetsData,o=e.colsHead,i=!1;for(var r in n){var s=n[r];if(!(s.length<1)){i=!0;for(var l=XLSX.utils.json_to_sheet(s),d=XLSX.utils.decode_range(l["!ref"]),c=d.s.c;c<=d.e.c;++c){var m=XLSX.utils.encode_col(c)+"1";if("undefined"!=typeof l[m]){var f=l[m];f.v=o[f.v].tt,l[m]=f}}l["!ref"]=XLSX.utils.encode_range(d);var u=[];for(var p in o)u.push({wch:o[p].wch});l["!cols"]=u,$.each(l,function(e,t){t.s={alignment:{wrapText:1}},l[e]=t}),XLSX.utils.book_append_sheet(a,l,r)}}if(!i)return void bootbox.alert({className:"modal-warning",message:t.data("mess-none")});var h=e.fileName+".xlsx",b=XLSX.write(a,{bookType:"xlsx",bookSST:!0,type:"binary"});try{saveAs(new Blob([s2ab(b)],{type:"application/octet-stream"}),h)}catch(_){return void bootbox.alert({message:"Error export file, please try again later!",className:"modal-danger"})}},error:function(e){bootbox.alert({className:"modal-danger",message:e.responseJSON})},complete:function(){a.addClass("hidden"),t.prop("disabled",!1)}}))}),$(".btn-noti-inventory").click(function(e){e.preventDefault();var t=$(this),a=t.data("url");if(!t.is("disabled")&&a){var n=t.data("noti"),o=t.find("i");bootbox.confirm({message:n,className:"modal-warning",buttons:{confirm:{label:confirmYes},cancel:{label:textCancel}},callback:function(e){e&&(t.prop("disabled",!0),o.removeClass("hidden"),$.ajax({type:"POST",url:a,data:{_token:siteConfigGlobal.token},success:function(e){bootbox.alert({className:"modal-success",message:e,buttons:{ok:{label:confirmYes}}})},error:function(e){bootbox.alert({className:"modal-danger",message:e.responseJSON,buttons:{ok:{label:confirmYes}}})},complete:function(){t.prop("disabled",!1),o.addClass("hidden")}}))}})}}),$(".btn-delete-item").click(function(){var e=$(this),t=e.data("noti");return bootbox.confirm({message:t,className:"modal-danger",buttons:{confirm:{label:confirmYes},cancel:{label:textCancel}},callback:function(t){t&&e.closest("form")[0].submit()}}),!1}),$(document).ready(function(){$(".el-short-content").shortedContent()})});