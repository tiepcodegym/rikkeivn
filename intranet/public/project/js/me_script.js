function _setStatus(t,e){"undefined"==typeof e&&(e=!1),e?_me_status.addClass("me_error"):_me_status.removeClass("me_error"),e&&(t+='<a class="close close_alert" href="javascript:void(0)">Ã—</a>'),_me_status.html(t).addClass("show")}function _showStatus(t,e){clearTimeout(_showTimeout),"undefined"==typeof e&&(e=!1),"undefined"==typeof t&&(t=text_error_occurred),_setStatus(t,e),e||(_showTimeout=setTimeout(function(){_me_status.removeClass("show")},3e3))}function _hideStatus(){clearTimeout(_showTimeout),_me_status.removeClass("show")}function scrollBottom(t){t.animate({scrollTop:t.prop("scrollHeight")},100)}function checkError(){var t=$("body").find("._pf_person_avg_col");if(t.hasClass("me_error"))return!0;var e=!1;return $("body").find("._pf_avg").each(function(){if($(this).hasClass("me_error"))return e=!0,!1}),e}function showModalSuccess(t){_modal_success.find(".text-default").html(t),_modal_success.modal("show")}function showModalError(t){"undefined"==typeof t&&(t=text_error_occurred),_modal_error.find(".text-default").html(t),_modal_error.modal("show")}function checkNewVersion(t,e,a){"undefined"==typeof e&&(e=null),"undefined"==typeof a&&(a="project");var o=new Date(t),n=new Date(SEP_MONTH);if(o.getTime()>n.getTime()){var s="",i="?";return e&&(s+="project"==a?"?project_id="+e:"?team_id="+e,i="&"),s+=i+"month="+t,window.location.href=newMeUrl+s,!0}return!1}var _processing=!1,_me_table=$("#_me_table"),_me_tbl_res=$("._me_table_responsive"),_me_status=$("#_me_alert"),_form_assign=$("#_me_assignee_form"),_status_content=$("#_status_content"),_modal_success=$("#modal-success-notification"),_modal_error=$("#modal-warning-notification"),_modal_confirm=$("#_modal_confirm"),GR_PERFORM=2,GR_NORMAL=1;!function(t){function e(){var e=t("#_me_project").val(),a=t("#_me_team").val();"undefined"!=typeof e?history.pushState({},"",x+"?project_id="+e+"&month="+t("#_me_month").val()):history.pushState({},"",x+"?team_id="+a+"&month="+t("#_me_month").val())}function a(a){t("#_me_month").html("<option value>"+text_loading+"</option>"),t.ajax({url:_loadMonthsProjectUrl,type:"GET",data:{project_id:a},dataType:"json",success:function(a){var n="<option value>"+text_select_month+"</option>";for(var s in a.data){var i=a.data[s];n+='<option value="'+i.timestamp+'">'+i.string+"</option>"}t(".team-of-project").text(a.team),t("#_me_month").html(n);var r=a.data.length;if(curr_month)t("#_me_month").val(curr_month),o(t("#eval_form_filter"));else if(r>0){var d=a.data[0].timestamp;d>time_now&&(d=time_now),t("#_me_month").val(d),o(t("#eval_form_filter"),!0),e()}}})}function o(e,a){"undefined"==typeof a&&(a=!1);var o=t("#_me_project").val(),s=t("#_me_team").val(),i=t("#_me_month").val();if("undefined"!=typeof i&&i){var r="project",d=null;if(o?d=o:s&&(d=s,r="team"),checkNewVersion(i,d,r))return!1;if(1==e.attr("data-change")||a){_me_table.addClass("hidden"),_form_assign.addClass("hidden"),_status_content.addClass("hidden");var l=e.attr("action");_setStatus('<i class="fa fa-spin fa-refresh"></i>'),t.ajax({url:l,type:"GET",data:{project_id:o,team_id:s,month:i},success:function(a){if(1==a.status){_me_table.removeClass("hidden"),_form_assign.removeClass("hidden"),_status_content.addClass("hidden"),t("#_me_table tbody").html(a.eval_items),t("#_me_assignee").html(a.option_leaders),e.attr("data-change",0),n(),_(!0),c(),curr_project_id=null,curr_month=null,a.submited||_form_assign.addClass("hidden"),_me_table.find(".select-search").select2({minimumResultsForSearch:-1}),_me_table.find("thead ._check_all").trigger("click");var o=t(".fixed-table thead tr:first .fixed-col").length;t(".fixed-table").tableHeadFixer({left:o})}else _status_content.html(a.eval_items).removeClass("hidden"),t("#_me_table tbody").html("");e.find('button[type="submit"]').prop("disabled",!1),_hideStatus(),t(".month-range-time").text("Date from: "+a.range_time.start+" to: "+a.range_time.end)},error:function(t){e.find('button[type="submit"]').prop("disabled",!1),_showStatus(t.responseJSON,!0),e.attr("data-change",0)}})}else e.find('button[type="submit"]').prop("disabled",!1)}}function n(){t("._item_select_assign").each(function(){var e=t(this).closest("td").attr("data-assignee");t(this).find('option[value="'+e+'"]').prop("selected",!0)})}function s(){var e=cm_tooltip.find(".me_comment_box"),a=e.attr("data-eval"),o=e.attr("data-attr")||null,n=t('tr[data-eval="'+a+'"] td[data-attr="'+o+'"] ._me_attr_point'),s=n.closest(".point_group").attr("data-group");n.length>0&&s==GR_PERFORM&&(n.val(n.attr("data-value")),n.next(".select2").find(".select2-selection__rendered").text(n.find('option[value="'+n.val()+'"]').text()))}function i(e,a,o,n){"undefined"==typeof o&&(o=!1);var s=e.find(".me_comment_box"),i=s.attr("data-attr"),r=s.attr("data-eval"),d=s.find(".me_comments_list"),_=s.find("._comment_loadmore"),l=e.find("._loading");if(!d.hasClass("loaded")||o){l.removeClass("hidden");var c={eval_id:r,attr_id:i},m=e.find(".me_comment_box").attr("data-comment-type");"undefined"!=typeof m&&(c.comment_type=m),t.ajax({url:a,type:"GET",data:c,success:function(e){l.addClass("hidden"),d.addClass("loaded").append(e.comment_html);var a=t('tr[data-eval="'+r+'"] td[data-attr="'+i+'"] ._me_attr_point');if(a.length>0){var o=a.closest(".point_group").attr("data-group"),s=a.val();o!=GR_PERFORM||s!=P_EXCELLENT&&s!=P_UNSATIS||d.find(".btn_del_comment").addClass("hidden")}scrollBottom(d),e.next_page_url?_.attr("href",e.next_page_url).removeClass("hidden"):_.attr("href","#").addClass("hidden");var c=d.closest(".dropdown").offset().top;c<0&&d.addClass("maxh-140"),t('tr[data-eval="'+r+'"] td[data-attr="'+i+'"]').data("current-commented",e.current_user_comment),"undefined"!=typeof n&&n(e)},error:function(t){_showStatus(t.responseJSON,!0),l.addClass("hidden")}})}}function r(){t("#overlay").length>0&&t("#overlay").removeClass("hidden")}function d(){t("#overlay").length>0&&t("#overlay").addClass("hidden")}function _(e){_me_table.find("tbody tr").each(function(){m(t(this).find('.point_group[data-group="'+GR_NORMAL+'"]:first')),t(this).find('.point_group[data-group="'+GR_PERFORM+'"]').each(function(){p(t(this))}),f(t(this).find('.point_group[data-group="'+GR_PERFORM+'"]:first'))}),h(),_me_table.find("tbody tr").each(function(){v(t(this).find('.point_group[data-group="'+GR_PERFORM+'"]:first')),e&&b(t(this).find('.point_group[data-group="'+GR_PERFORM+'"]:first'))})}function l(e,a){"undefined"==typeof a&&(a=!1),t.isArray(e)||(e=[e]);for(var o=[],n=0;n<e.length;n++){var s=e[n],i=s.closest("tr"),r=s.attr("data-attr"),d=i.attr("data-eval"),_=s.attr("min"),l=s.attr("max"),c=s.attr("data-value"),u=s.val(),g=s.data("integer");if("undefined"!=typeof g&&(u=u.replace(/[^0-9]/g,"")),u=u?parseInt(u):0,s.val(u),u==parseInt(c)||u<parseInt(_)||u>parseInt(l))return void s.val(_);var y=s.closest("tr").find("._point_avg ._value");m(s),p(s),f(s),h(),v(s),b(s),o.push({eval_id:d,attr_id:r,point:u,avg_point:y.text()})}o.length<1||(_setStatus('<i class="fa fa-spin fa-refresh"></i>'),t.ajax({url:_addAttrPointUrl,type:"POST",data:{data_evals:o,_token:_token},success:function(t){if(t.length>0){_showStatus("Saved");for(var e in t){var o=t[e],n=_me_table.find('tr[data-eval="'+o.id+'"]'),s=n.find('td [data-attr="'+o.attr_id+'"]');s.attr("data-value",u),a&&s.prop("disabled",!0),i.find("._contribute_val").text(o.contribute_label),i.attr("data-change",1)}}},error:function(a){for(var o in e){var n=e[o],s=n.attr("data-value");n.val(s),m(n),p(n),f(n),v(n),b(n)}_me_table.find(".select-search").each(function(){var e=t(this).find("option:selected").text(),a=t(this).next(".select2");a.find(".select2-selection__rendered").attr("title",e).text(e)}),h(),_showStatus(a.responseJSON,!0)}}))}function c(){var e=[];_me_table.find("._point_avg").each(function(){var a=t(this).closest("tr");if(a.attr("data-edit")){var o=parseFloat(t(this).find("._value").text()),n=a.attr("data-eval");e.push({eval_id:n,value:o})}}),e.length<1||t.ajax({url:_updateAvgPointUrl,type:"POST",dataType:"json",data:{_token:_token,data_evals:e},success:function(t){if(t.length>0)for(var e in t)_me_table.find('tr[data-eval="'+t[e].id+'"] ._contribute_val').text(t[e].label),_me_table.find('tr[data-eval="'+t[e].id+'"]').attr("data-edit",0)}})}function m(e){var a=e.closest("tr"),o=0,n=parseFloat(t(".th_avg_rule_val").attr("data-weight"));a.find('.point_group[data-group="'+GR_NORMAL+'"] ._me_attr_point').each(function(){var e=t(this),a=parseFloat(e.val()),n=parseFloat(e.attr("data-weight"));isNaN(a)&&(a=parseFloat(e.text())),a||(a=0),o+=a*n});var s=t.number(o/(2*n),2,".",",");a.find("._avg_rules").text(s)}function f(e){var a=e.closest("tr"),o=0,n=0;a.find('.point_group[data-group="'+GR_PERFORM+'"]').each(function(){var e=t(this).find("._me_attr_point"),a=parseFloat(e.val());isNaN(a)&&(a=parseFloat(e.text())),a||(a=0),a>P_NA&&(o+=a,n++)}),o=t.number(o/n,2,".",","),a.find("._pf_person_avg").text(o)}function p(e){var a=e.attr("data-attr"),o=0,n=0;t("body").find('.point_group[data-group="'+GR_PERFORM+'"][data-attr="'+a+'"]').each(function(){var e=t(this).find("._me_attr_point"),a=parseFloat(e.val());isNaN(a)&&(a=parseFloat(e.text())),a>P_NA&&(o+=a,n++)});var s=o/n,i=t("body").find('._pf_avg[data-attr="'+a+'"]');i.text(u(s.toFixed(0)))}function u(t){return t>=P_EXCELLENT?optionsPoint[P_EXCELLENT]:t>=P_GOOD?optionsPoint[P_GOOD]:t>=P_FAIR?optionsPoint[P_FAIR]:t>=P_SATIS?optionsPoint[P_SATIS]:t>=P_UNSATIS?optionsPoint[P_UNSATIS]:optionsPoint[P_NA]}function h(){var e=0,a=0;t("body").find("._pf_person_avg").each(function(){e+=parseFloat(t(this).text()),a++});var o=e/a*100,n=t("body").find("._pf_person_avg_col");n.text(o.toFixed(0)+"%")}function v(e){var a=e.closest("tr"),o=parseFloat(a.find("._project_point").text()),n=parseFloat(a.find("._project_type").text()),s=Math.min(o*n*MAX_POINT/MAX_PP,5);a.find("._perform_value").text(t.number(s,2,".",","))}function b(e){var a=parseInt(t(".th_perform_val").attr("data-weight")),o=parseInt(t(".th_avg_rule_val").attr("data-weight")),n=parseInt(t(".th_individual_val").attr("data-weight")),s=e.closest("tr");if(s.attr("data-edit")){var i=parseFloat(s.find("._avg_rules").text()),r=parseFloat(s.find("._pf_person_avg").text()),d=parseFloat(s.find("._perform_value").text()),_=i*o+r*n+d*a;_=t.number(_/100,2,".",","),s.find("._point_avg ._value").text(_)}}function g(){var e=_me_table.find("._check_item:checked").length;if(e<1)return t(".btn_form_feedback").prop("disabled",!0),void t(".btn_form_accept").prop("disabled",!0);var a=0,o=0;textWarning="",_me_table.find("._check_item:checked").each(function(){var e=_me_table.find('tr[data-eval="'+t(this).closest("tr").attr("data-eval")+'"]'),n=e.find("._btn_accept"),s=e.find("._btn_feedback");s.hasClass("is-disabled")&&(textWarning+="<br />"+e.find(".employee").text()+"-"+e.find(".project_code_auto").text(),a++),n.length>0&&!n.is(":disabled")&&o++}),a>0?(message=t(".btn_form_feedback").data("mesasge"),message2=t(".btn_form_feedback").data("message2"),t(".btn_form_feedback").addClass("is-disabled"),t(".btn_form_feedback").attr("data-warning",message+textWarning+"<br />"+message2)):t(".btn_form_feedback").removeClass("is-disabled"),e>0?t(".btn_form_feedback").prop("disabled",!1):t(".btn_form_feedback").prop("disabled",!0),o>0?t(".btn_form_accept").prop("disabled",!1):t(".btn_form_accept").prop("disabled",!0)}function y(){var t=window.location;window.history.pushState({},document.title,t.origin+t.pathname)}_error_text&&showModalError(_error_text);var x=window.location.origin+window.location.pathname;t("#_me_month").change(function(){t(this).closest("form").attr("data-change",1),t(this).closest("form").submit(),e()}),curr_team_id&&t("#_me_team").val(curr_team_id),t("#_me_team").change(function(){t(this).val()&&(o(t("#eval_form_filter"),!0),e())}),IS_TEAM&&(curr_month&&t("#_me_month").val(curr_month),t("#_me_team").val()&&t("#_me_month").val()&&o(t("#eval_form_filter"))),t("#_me_project").change(function(){var o=t(this).val();o&&(_me_table.addClass("hidden"),_form_assign.addClass("hidden"),a(o),e())}),curr_project_id&&t("._me_review_page").length<1&&(t("#_me_project").val(curr_project_id),a(curr_project_id)),t("#eval_form_filter").submit(function(){return o(t(this)),!1}),t("body").on("change","._me_attr_point",function(){var e=t(this),a=t(this).val(),o=(t(this).attr("data-value"),t(this).closest(".point_group")),n=o.attr("data-group"),s=o.data("current-commented")||0;n!=GR_PERFORM||a!=P_EXCELLENT&&a!=P_UNSATIS?l(t(this)):s?l(t(this)):(cm_tooltip.html(o.find(".me_comment_box").clone()),_setStatus('<i class="fa fa-spin fa-refresh"></i>'),e.prop("disabled",!0),i(cm_tooltip,_loadAttrCommentsUrl,!1,function(t){_hideStatus(),e.prop("disabled",!1),s=t.current_user_comment,s||(o.trigger({type:"mousedown",which:3}),cm_tooltip.find(".me_comment_title").next("p").length<1&&cm_tooltip.find(".me_comment_title").after('<p style="color: #00c0ef;"><i>'+textRequiredComment+"</i></p>"),cm_tooltip.find(".me_comment_box").attr("data-change-point",a))})),cm_tooltip.find(".me_comments_list").removeClass("loaded")}),t("body").on("click",".me_comment_submit",function(){var e=t(this),a=t(this).closest(".me_comment_box"),o=a.attr("data-eval"),n=a.attr("data-attr")||null,s=a.attr("data-project"),i=parseInt(a.attr("data-leader")||null),r=parseInt(a.attr("data-staff")||null),d=a.attr("data-change-point")||null,_=t('tr[data-eval="'+o+'"] td[data-attr="'+n+'"] ._me_attr_point'),c=t(this).closest(".me_comment_form"),m=c.find(".me_comment_text"),f=a.find(".me_comments_list"),p=m.val();if(""!=p.trim()){var u=[o];t('#_me_table tr[data-eval="'+o+'"] ._check_item').is(":checked")&&t("#_me_table ._check_item:checked").each(function(){var e=t(this).val();e!=o&&u.push(e)});var h={_token:_token,comment_text:p,"eval_ids[]":u,attr_id:n,project_id:s,is_leader:i,is_staff:r},v=a.attr("data-comment-type");"undefined"!=typeof v?h.comment_type=v:h["eval_ids[]"]=[o],e.prop("disabled",!0),t.ajax({url:_addCommentUrl,type:"POST",data:h,success:function(t){for(var s in t){var i=t[s],r=_me_table.find('tbody tr[data-eval="'+i.id+'"]');n?(r.find('td[data-attr="'+n+'"]').addClass("has_comment "+i.td_type),r.find('td[data-attr="'+n+'"]').data("current-commented",1)):r.find("td.note_group").addClass("has_comment "+i.td_type);var c=i.change_status;c.approved||c.closed?r.find("._btn_accept").prop("disabled",!1):r.find("._btn_accept").prop("disabled",!0),c.feedback?r.find("._btn_feedback").removeClass("is-disabled"):r.find("._btn_feedback").addClass("is-disabled")}f.append(t[o].comment_item).addClass("loaded"),f.closest("td").addClass("has_comment "+t[o].td_type);var p=f.closest(".dropdown").offset().top;p<0&&f.addClass("maxh-140"),scrollBottom(f),m.val(""),g(),e.prop("disabled",!1),m.attr("rows",1);var u=_.closest(".point_group").attr("data-group"),h=_.val();u!=GR_PERFORM||h!=P_EXCELLENT&&h!=P_UNSATIS||f.find(".btn_del_comment").addClass("hidden"),d&&(_.val(d),l(_),_.next(".select2").find(".select2-selection__rendered").text(_.find('option[value="'+d+'"]').text()),a.removeAttr("data-change-point"),a.find(".me_comment_title").next("p").remove())},error:function(t){_showStatus(t.responseJSON,!0),e.prop("disabled",!1)}})}}),t("body").on("keydown",".me_comment_text",function(e){if(13==e.which){var a=t(this).attr("rows");if(a||(a=1),a=parseInt(a),a>1)return!0;t(this).attr("rows",a+1)}}),t("body").on("click",".btn_del_comment",function(e){e.preventDefault();var a=t(this),o=a.data("url");a.prop("disabled",!0);var n=a.closest(".me_comment_box").attr("data-eval"),s=a.closest(".me_comment_box").attr("data-attr");_setStatus('<i class="fa fa-spin fa-refresh"></i>'),t.ajax({url:o,type:"DELETE",data:{_token:_token,eval_id:n,attr_id:s},success:function(e){var o=e.comment_id;t("#me_comment_"+o).remove(),_hideStatus(),a.prop("disabled",!1);var i=e.change_status;if(i){var r=_me_table.find('tbody tr[data-eval="'+n+'"]');i.approved||i.closed?r.find("._btn_accept").prop("disabled",!1):r.find("._btn_accept").prop("disabled",!0),i.feedback?r.find("._btn_feedback").addClass("is-disabled"):r.find("._btn_feedback").removeClass("is-disabled"),r.find('td[data-attr="'+s+'"]').removeClass("td_gl_type td_pm_type td_st_type td_coo_type").addClass(e.td_class)}},error:function(t){_showStatus(t.responseJSON,!0),a.prop("disabled",!1)}})}),t("body").on("mousedown",".point_group, .note_group",function(e){if(3==e.which){var a=t(this),o=a.find(".me_comment_box"),n=t(window).height(),s=t(window).width(),r=a.offset().left,d=n-a.offset().top;t(".point_group, .note_group").removeClass("highlight"),a.addClass("highlight"),cm_tooltip.css("bottom",d).css("left",r).css("right","auto").addClass("open").attr("data-left",r).attr("data-scroll",t("._me_table_responsive").scrollLeft());var _=o.clone();cm_tooltip.html(_),i(cm_tooltip,_loadAttrCommentsUrl),cm_tooltip.find(".me_comment_text").focus(),cm_tooltip.find(".me_comment_title").next("p").remove(),cm_tooltip.offset().left+cm_tooltip.width()>=s&&(cm_tooltip.css("right",s-r-a.width()-10).css("left","auto"),cm_tooltip.attr("data-left",cm_tooltip.offset().left))}}),t("body").on("contextmenu",".point_group, .note_group",function(){return!1}),t("body").on("click","._comment_loadmore",function(e){e.preventDefault();var a=t(this).closest("#_me_comments");"#"!=t(this).attr("href")&&i(a,t(this).attr("href"),!0)}),t("._me_table_responsive").on("scroll",function(){var e=t(this).scrollLeft(),a=parseInt(cm_tooltip.attr("data-left")),o=parseInt(cm_tooltip.attr("data-scroll"));cm_tooltip.css("left",a-e+o).css("right","auto")}),t(document).click(function(e){if(t(e.target).closest(".point_group").length<1){var a=t(".point_group");a.removeClass("open"),a.find(".me_comments_list").removeClass("maxh-140"),a.find(".me_comment_box").css("right","auto").css("top","auto")}if(t(e.target).closest(".note_group").length<1){var o=t(".note_group");o.removeClass("open"),o.find(".me_comments_list").removeClass("maxh-140"),o.find(".me_comment_box").css("right","auto").css("top","auto")}if(t(e.target).closest("#_me_comments").length<1){if(3==e.which)return;cm_tooltip.removeClass("open"),t(".point_group, .note_group").css("right","auto").css("top","auto").removeClass("highlight"),s()}}),t("body").on("click",".me_comment_box .close",function(){cm_tooltip.removeClass("open").css("right","auto").css("top","auto"),t(".point_group, .note_group").removeClass("highlight"),s()}),_form_assign.submit(function(){var e=t(this),a=t(this).find('button[type="submit"]'),o=[],n=t("#_me_status").val(),s=t("#_me_assignee").val();if(t("#_me_alert .fa-refresh").length>0&&t("#_me_alert").hasClass("show"))return a.prop("disabled",!1),!1;if(checkError())return a.prop("disabled",!1),showModalError(text_error_max_value),!1;if(!s||0==s)return a.prop("disabled",!1),showModalError(text_error_assignee),!1;if(_me_table.find("tbody tr ._check_item:checked").each(function(){o.push(t(this).val())}),o.length<1)return showModalError(NoneItemChecked),a.prop("disabled",!1),!1;var i=o.length===_me_table.find("tbody tr ._check_item").length;return _modal_confirm.modal("show"),_modal_confirm.find(".text-default").html(a.data("noti")),t(".btn-outline").one("click",function(r){r.preventDefault(),t(this).hasClass("btn-ok")?(_modal_confirm.modal("hide"),_setStatus('<i class="fa fa-spin fa-refresh"></i>'),t.ajax({url:e.attr("action"),type:"POST",data:{"eval_ids[]":o,assignee:s,status:n,_token:_token},success:function(o){a.prop("disabled",!1),_showStatus(o.message),t.each(o.results,function(e,a){var o=t('#_me_status option[value="'+a.status+'"]').text(),n=t('#_me_table tbody tr[data-eval="'+e+'"] ._status_text');if(n.text(o),!a.can_change){var s=n.closest("tr").find("._me_attr_point");s.each(function(){t(this).val()||t(this).val(0)}),s.prop("disabled",!0),n.closest("tr").find("._me_general_comment").prop("disabled",!0),_me_table.find('tbody tr[data-eval="'+e+'"] ._check_item').remove()}}),i&&e.addClass("hidden")},error:function(t){a.prop("disabled",!1),_showStatus(t.responseJSON,!0)}})):a.prop("disabled",!1)}),!1}),t("body").on("mouseenter","._action_btns",function(){t(this).addClass("open")}),t("body").on("mouseleave","._action_btns",function(){t(this).removeClass("open")}),t("body").on("submit","._me_item_form",function(){var e=t(this),a=e.find('button[type="submit"]'),o=e.closest("._action_btns").find(".status-btn"),n=e.find('select[name="status"]');return checkError()?(a.prop("disabled",!1),showModalError(text_error_max_value),!1):(_setStatus('<i class="fa fa-spin fa-refresh"></i>'),t.ajax({url:t(this).attr("action"),type:"POST",data:t(this).serialize(),success:function(t){_hideStatus(),_modal_success.modal("show"),_modal_success.find(".text-default").html(t.message),n.val(t.status),a.prop("disabled",!1);var s=e.find('select[name="status"] option:selected').text();o.text(s)},error:function(t){_showStatus(t.responseJSON),a.prop("disabled",!1)}}),!1)}),t("body").on("mousedown",".input_select input",function(e){1!=e.which||t(this).prop("disabled")||(t("body").find(".input_select").removeClass("show"),t("body").find(".point_group").removeClass("open"),t(this).parent().hasClass("show")?t(this).parent().removeClass("show"):t(this).parent().addClass("show"))}),t("body").on("click",".input_select select",function(){t(this).closest(".point_group").removeClass("show_tooltip")}),t("body").on("keypress keyup blur",".input_select input",function(t){var e=t.which?t.which:t.keyCode;return!(e>31&&(e<48||e>57)&&46!=e)||void t.preventDefault()}),t("body").click(function(e){t(e.target).closest(".input_select").length<1&&t("body").find(".input_select").removeClass("show")}),t("body").on("click",".close_alert",function(e){e.preventDefault(),t(this).closest("#_me_alert").html("").removeClass("show")}),t("body").on("click","a.disabled",function(t){t.preventDefault()}),t("body").on("submit","._actions_form",function(e){var a=t(this).find('button[type="submit"]');a.prop("disabled",!0),_me_table.find("tbody tr").removeClass("tr_error");var o=t(this),n=[];t("#_me_table ._check_item:checked").each(function(){if(a.hasClass("btn_form_accept")){var e=t(this).closest("tr").attr("data-eval");t('#_me_table tr[data-eval="'+e+'"] ._btn_accept').length>0&&n.unshift(t(this).val())}else n.unshift(t(this).val())});var s=o.find('input[name="action"]').val();return _setStatus('<i class="fa fa-spin fa-refresh"></i>'),t.ajax({url:o.attr("action"),type:"POST",dataType:"json",data:{_token:_token,"eval_ids[]":n,action:s},success:function(e){_showStatus(e),t("._check_all").prop("checked",!1),window.location.reload()},error:function(e){_hideStatus();var a=e.responseJSON;showModalError(a.message),"undefined"!=typeof a.eval_id&&_me_table.find('tr[data-eval="'+a.eval_id+'"]').addClass("tr_error"),t('._actions_form button[type="submit"]').prop("disabled",!1)}}),!1}),t("body").on("mouseenter",".tooltip_group i",function(e){var a=t(this).closest("th"),o=t(window).height(),n=t(window).width(),s=a.offset().left+a.width()/2,i=o-a.offset().top,r=t(this).parent().find(".me_tooltip");me_tooltip.html(r.html()).addClass("open"),me_tooltip.css("bottom",i).css("left",s),r.hasClass("text-center")&&me_tooltip.addClass("text-center"),me_tooltip.height()>a.offset().top-20&&me_tooltip.css("top",0).css("bottom","auto"),me_tooltip.offset().left+me_tooltip.width()>n-20&&me_tooltip.css("right",-me_tooltip.width()/2).css("left","auto");var d=a.data("name")||"";a.hasClass("cal-value")&&""!=d&&t('[data-related-col="'+d+'"]').addClass("highlight")}),t("body").on("mouseleave",".tooltip_group i",function(){me_tooltip.html("").removeClass("open text-center").css("bottom",0).css("left",0).css("top","auto").css("right","auto");var e=t(this).closest("th"),a=e.data("name")||"";e.hasClass("cal-value")&&""!=a&&t('[data-related-col="'+a+'"]').removeClass("highlight")}),t("body").on("click",'.form_item_confirm button[type="submit"]',function(){var e=t(this);if(_modal_confirm.find(".btn-ok").removeClass("display-none"),e.hasClass("is-disabled"))return _modal_confirm.modal("show"),_modal_confirm.find(".text-default").html(e.data("warning")),_modal_confirm.find(".btn-ok").addClass("display-none"),!1;var a=t(this).closest("form");return _modal_confirm.modal("show"),_modal_confirm.find(".text-default").html(e.data("noti")),t(".btn-outline").one("click",function(e){return e.preventDefault(),t(this).hasClass("btn-ok")?(_modal_confirm.modal("hide"),a.submit(),!0):(_modal_confirm.modal("hide"),!1)}),!1}),t(document).ready(function(){t("._me_review_page").length>0&&_(!0),setTimeout(function(){d()},300)}),t("body").on("change","select.select-grid, .grid-pager-box select, .form-pager input",function(){r()}),t("body").on("click",".btn-reset-filter, .btn-search-filter, .paginate_button a",function(e){return t(this).parent().hasClass("disabled")?(e.stopImmediatePropagation(),!1):void r()}),t("._check_all").length>0&&(t("._check_item").prop("checked",!1),setTimeout(function(){t('._actions_form button[type="submit"]').prop("disabled",!0)},1e3),t("body").on("change","#_me_table ._check_all",function(){t("#_me_table ._check_item").prop("checked",t(this).is(":checked")),g()}),t("body").on("change","#_me_table ._check_item",function(){var e=t("#_me_table ._check_item").length;t("#_me_table ._check_all").prop("checked",t("#_me_table ._check_item:checked").length===e),g()})),t("._btn_delete").on("click",function(e){t("#modal-delete-confirm").removeClass("modal-warning").addClass("modal-danger")}),t("#modal-delete-confirm").on("hidden.bs.modal",function(e){t(this).addClass("modal-warning").removeClass("modal-danger")}),t(".btn-reset-filter").on("click",function(){y()}),t(".filter-grid").on("change",function(){y()}),t("body").on("mouseenter",'.date-tooltip [data-toggle="tooltip"]',function(){t(this).closest("td").addClass("z-index-3000")}),t("body").on("mouseleave",'.date-tooltip [data-toggle="tooltip"]',function(){t(this).closest("td").removeClass("z-index-3000")})}(jQuery);var _showTimeout;