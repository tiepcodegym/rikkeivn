function checkAllProgramsLanguage(){function e(e,a){var r=0;for(r;r<e.length;r++)if(e[r]===a)return!0;return!1}var a=reloadTextSelect();$("#programLanguages").val(a);var r,t=/^[+]?([0-9]{1,2})[.,]?([0-9]{1,2})?$/;$('input[name="inputYear[]"]').each(function(){$(this).parent().find("label.error").remove(),""===$(this).val()?($(this).after('<label id="recruiter-error" class="error" for="">'+requiredText+"</label>"),r=1):$(this).val()>=100?($(this).after('<label id="recruiter-error" class="error" for="">'+valueYear+"</label>"),r=1):t.test($(this).val())===!1&&($(this).after('<label id="recruiter-error" class="error" for="">'+invalidYear+"</label>"),r=1)});var n=[];$("select[name='programs[]'] :selected").each(function(){$(this).parent().parent().find("label.error").remove(),"0"===$(this).val()?($(this).parent().after('<label id="recruiter-error" class="error" for="">'+requiredText+"</label>"),r=1):n.push($(this).val())});var l=[],i=0;for(i;i<n.length;i++)e(l,n[i])?$("select[name='programs[]'] :selected").each(function(){$(this).val()===n[i]&&($(this).parent().parent().find("label.error").remove(),$(this).parent().after('<label id="recruiter-error" class="error" for="">'+languageRepeats+"</label>"))}):l.push(n[i]);return n.length===l.length&&1!==r}function reloadTextSelect(){var e="";return $("select[name='programs[]'] :selected").each(function(){"0"!==$(this).val()&&(e=e+$(this).text()+", ")}),e=e.substring(0,e.length-2)}function chkFileUpload(){var e=$("#cv").val();if(""==e)return!0;var a=e.replace(/^.*\./,"");switch(a=a==e?"":a.toLowerCase()){case"doc":case"docx":case"xls":case"xlsx":case"pdf":return a;default:return!1}}function isSizeAllow(e){return"undefined"==typeof e.files[0]||e.files[0].size<=5242880}function setPresenter(){$("#presenter_error").remove(),$("#other-pre_error").remove();var e=$("#presenter").val();return 0==parseInt(e)||null==e?($("#presenter").after('<label id="presenter_error" class="error">This field is required.</label>'),!1):($("input[name=presenter_id]").val(e),$("#modal-channel").modal("hide"),$(".view-detail").removeClass("hidden"),$("#channel_id").focus(),void $("#presenter").attr("data-old-id",$("#presenter").val()))}function reset(){$("#presenter").val("0").trigger("change"),$("span[aria-labelledby=select2-presenter-container]").removeClass("hidden")}function cancelPresenter(){var e=$("#channel_id").attr("data-val");null!=e&&($("#channel_id").val(e).trigger("change"),isPresenter(e)?$(".view-detail").removeClass("hidden"):$(".view-detail").addClass("hidden"));var a=$("#presenter").attr("data-old-id");$("#presenter").val(a).trigger("change"),$("#modal-channel").modal("hide")}function viewDetail(){$("#presenter_error").remove(),$("#other-pre_error").remove(),$("#modal-channel").modal("show")}function isPresenter(e){var a=$("#channel_id option[value="+e+"]").attr("is_presenter");return a==presenterYes}function trimText(e){for(var a="",r=e.split(","),t=0;t<r.length;t++)a?a+=", "+r[t].trim():a=r[t].trim();return a}function setTeamText(e){var a=e.find(".multiselect-selected-text");a.text(trimText(a.text()))}function getLangUsed(){var e=[];return $(".language-container .language").each(function(){var a=$(this).val();0!=a&&e.push(a)}),e}function validate(){var e=!1;return $("#modal-choose-language .modal-footer .error").remove(),$(".language-container select.language").each(function(){removeLangLabelError($(this)),$(this).parent().find("label.error").remove();var a=$(this).val();0==a&&(e=!0,$(this).after("<label class='error'>"+requiredText+"</label>"))}),e}function removeLangLabelError(e){e.parent().find("label.error").remove()}function saveLang(){if(validate())return!1;$("#form-create-candidate .language-val").remove(),prependLanguageVal(),$(".language-save").html($(".language-container").html()),$("#modal-choose-language").modal("hide");var e="";$(".language-container .language").each(function(){var a=$(this).find("option:selected").text().trim();e+=e?", "+a:a}),$("#languages").val(e)}function prependLanguageVal(){$(".language-container .row-add").each(function(){var e=$(this).find("select.language").val(),a=$(this).find("select.level").val();$("#form-create-candidate").prepend('<input class="language-val" type="hidden" name="languages['+e+']" value="'+a+'" />')})}function removeLang(e){$(e).closest(".row-add").remove()}function formatState(e){return e.id?$('<span><i class="fa fa-star-o '+$(e.element).attr("class")+'"></i> '+e.text+"</span>"):e.text}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="_token"]').attr("content")}}),$(document).ready(function(){var e=!1;$("#position_apply").change(function(){var a=$("#position_apply"),r=$.inArray(devPosition,a.val());e=0===r}),$("#form-create-candidate").validate({ignore:':hidden:not("#team_id, #position_apply")',rules:{fullname:"required",birthday:"required",email:{required:!0,validEmail:$.trim($("#email").val()),remote:{type:"POST",url:urlCheckMail,data:{_token:token,id:id,email:function(){return $('#form-create-candidate :input[name="email"]').val()}}}},mobile:{validatePhone:!0},skype:"required",experience:"required",received_cv_date:"required",recruiter:{valueNotEquals:"0"},"teams[]":"required","positions[]":"required",type:{valueNotEquals:"0"},note:{required:checkEdit},channel_id:{valueNotEquals:"0"}},messages:{fullname:requiredText,birthday:requiredText,email:{required:requiredText,validEmail:invalidEmail,remote:uniqueMail},mobile:{validatePhone:phoneValidText},skype:{required:requiredText},experience:requiredText,received_cv_date:requiredText,recruiter:{valueNotEquals:requiredText},"teams[]":requiredText,"positions[]":requiredText,channel_id:{valueNotEquals:requiredText},type:{valueNotEquals:requiredText},note:{required:requiredText},university:requiredText}}),$(".date").datepicker({todayBtn:"linked",language:"it",autoclose:!0,todayHighlight:!0,format:"yyyy-mm-dd"}),$("#birthday").datepicker("setEndDate","-1d"),$(".btn-upload").click(function(){$("#cv").click()})}),$(document).on("click",".btn-delete",function(e){$(this).parent("div").parent("div").remove();var a=reloadTextSelect();$("#programLanguages").val(a)}),$(document).mouseup(function(e){var a=$("#expand");a.is(e.target)||0!==a.has(e.target).length||checkAllProgramsLanguage()}),$(document).on("keyup",'input[name="inputYear[]"]',function(e){var a=/^[+]?([0-9]{1,2})[.,]?([0-9]{1,2})?$/;$(this).parent().find("label.error").remove(),""===$(this).val()?$(this).after('<label id="recruiter-error" class="error" for="">'+requiredText+"</label>"):$(this).val()>=100?$(this).after('<label id="recruiter-error" class="error" for="">'+valueYear+"</label>"):a.test($(this).val())===!1&&$(this).after('<label id="recruiter-error" class="error" for="">'+invalidYear+"</label>")}),$(document).on("change","#program",function(e){function a(e,a){var r=0;for(r;r<e.length;r++)if(e[r]===a)return!0;return!1}var r=reloadTextSelect();$("#programLanguages").val(r);var t=[];$("select[name='programs[]'] :selected").each(function(){"0"===$(this).val()||($(this).parent().parent().find("label.error").remove(),t.push($(this).val()))}),$(this).parent().find("label.error").remove(),"0"===$(this).val()&&$(this).after('<label id="recruiter-error" class="error" for="">'+requiredText+"</label>");var n=[],l=0;for(l;l<t.length;l++)a(n,t[l])?$("select[name='programs[]'] :selected").each(function(){$(this).val()===t[l]&&($(this).parent().parent().find("label.error").remove(),$(this).parent().after('<label id="recruiter-error" class="error" for="">'+languageRepeats+"</label>"))}):n.push(t[l])}),$("#form-create-candidate").submit(function(e){chkFileUpload()&&isSizeAllow(document.getElementById("cv"))||(e.preventDefault(),$("button[type=submit]").prop("disabled",!1))}),$("#cv").on("change",function(){if($(this).parent().find("label#cv-error").remove(),!chkFileUpload())return void $("#cv").after('<label id="cv-error" style="color:red;" for="cv">'+notAllowTypeText+"</label>");if(isSizeAllow(this)||$("#cv").after('<label id="cv-error" style="color:red;" for="cv">'+notAllowSizeText+"</label>"),"pdf"===chkFileUpload()){var e=$("#cv").prop("files")[0],a=new FormData;a.append("fileup",e),urlGenerateCV="undefined"==typeof urlGenerateCV?"https://cv-parser.rikkei.org/resume-parser":urlGenerateCV,$.ajax({url:urlGenerateCV,type:"POST",contentType:!1,cache:!1,processData:!1,data:a,success:function(e){e&&($('#gender>option[value="0"]').attr("selected","selected"),"nam"==e.gender&&$('#gender>option[value="1"]').attr("selected","selected"),$('#recruiter>option[value="'+useremail+'"]').attr("selected","selected"),$("#other_contact").html(e.website),$("#birthday").val(e.birthday),$("#university").html(e.college),$("#email").val(e.email),$("#fullname").val(e.name),$("#mobile").val(e.phone),$("#old_company").val(e.company),$("#certificate").val(e.certificate),$("#received_cv_date").append(receivedCvDate),$("#found_by").html('<option value="'+userId+'" selected="selected">'+username+"</option>"),$("#gender").select2(),$("#recruiter").select2())}})}}),$("#experience").on("change",function(){var e=1;$('#type>option[selected="selected"]').prop("selected",!1),$(this).val()>="1.2"&&$(this).val()<="3"?e=2:$(this).val()>"3"&&(e=3),$("#type>option[value="+e+"]").prop("selected",!0),$("#type").select2()}),$("#channel_id").on("focusin",function(){$(this).attr("data-val",$(this).val())}),$("#channel_id").on("change",function(){var e=$(this).find("option:selected").attr("is_presenter");e==presenterYes?($(".view-detail").removeClass("hidden"),$("#modal-channel").modal("show")):$(".view-detail").addClass("hidden"),channelChange.indexOf($("#channel_id").val())!==-1?$(".cost").removeClass("hidden"):$(".cost").addClass("hidden")}),$("input[name=presenter_type]").on("change",function(){$("#presenter_error").remove(),$("#other-pre_error").remove();var e=$(this).val();e==presenterTypeCom?($(".presenter-id-container").removeClass("hidden"),$(".other-pre").addClass("hidden")):($(".presenter-id-container").addClass("hidden"),$(".other-pre").removeClass("hidden"))}),$(document).ready(function(){$(".save_values").on("click",function(){if(!checkAllProgramsLanguage())return $("#programLanguages").attr("aria-expanded",!0),$("#expand").attr("aria-expanded",!0),$("#expand").attr("style","width: 93%; border: 1px solid rgb(210, 214, 222); height: auto;"),$("#expand").addClass("collapse in"),!1;var e=[];$("input, select, textarea, checkbox, radio").each(function(){$(this).data("restore",$(this).val()),e.push({key:this.id,value:$(this).val()})}),e.push({key:"language_save",value:$(".language-save").html()}),localStorage.setItem("data",JSON.stringify(e))}),$("#restore_values").on("click",function(){var e=JSON.parse(localStorage.getItem("data"));$.each(e,function(e,a){if("language_save"==a.key)$("#modal-choose-language .language-container").html(a.value),$(".language-save").html($(".language-container").html()),prependLanguageVal();else{var r=$("#"+a.key);if("file"!==r.attr("type")){var t=r.attr("class");if(void 0!==t&&t.indexOf("multiple_select")>0){r.multiselect("select",a.value);var n=$("#"+a.key+" + .btn-group");setTeamText(n)}else r.val(a.value).trigger("change")}}})})}),$("#presenter").on("change",function(){$("#presenter_error").remove();var e=$(this).val();0==e&&$(this).after('<label id="presenter_error" class="error">This field is required.</label>')}),$(document).on("click","#languages",function(){$("#modal-choose-language .language-container").html($(".language-save").html()),$("#modal-choose-language").modal("show")}),$(document).on("change",".language-container .level",function(){$(this).find("option[value="+$(this).val()+"]").attr("selected",!0)}),$(document).on("change",".language-container .language",function(){var e=getLangUsed();removeLangLabelError($(this)),$(".language-container .language option").prop("disabled",!1),$(".language-container .language").each(function(){var a=$(this),r=a.val();$.each(e,function(e,t){t!=r&&a.find("option[value="+t+"]").prop("disabled",!0)})});var a=$(this).val();$(this).find("option[value="+a+"]").attr("selected",!0);var r=$(this).closest(".row-add").find("select.level");r.parent().parent().find("label");r.html("<option value='0'>"+chooseLevelText+"</option>"),"undefined"!=typeof langArray[a]&&$.each(langArray[a],function(e,a){r.append("<option value='"+e+"'>"+a+"</option>")})}),$(document).on("click",".btn-add-lang",function(){$(this).before($(".add-box-lang").html());var e=getLangUsed();$.each(e,function(e,a){$(".language-container .language:last option[value="+a+"]").prop("disabled",!0)})}),$(document).ready(function(){var e=[];$(".language-save .language").each(function(){var a=$(this).val();0!=a&&e.push(a)}),$.each(e,function(e,a){$(".language-save .language option:not(:selected)[value="+a+"]").prop("disabled",!0)})}),select2Employees("#found_by"),select2Employees("#presenter"),$("#interested").select2({templateResult:formatState,templateSelection:formatState}),$(document).ready(function(){$("#form-recommend-candidate").validate({rules:{fullname:"required",comment:"required",recruiter:"required",region:"required",cv:{required:checkEdit},email:{required:!0,validEmail:$.trim($("#email").val()),remote:{type:"POST",url:urlCheckMailRecommend,data:{_token:token,id:id,email:function(){return $('#form-recommend-candidate :input[name="email"]').val()}}}},mobile:{required:!0,validatePhone:!0}},messages:{fullname:requiredText,comment:requiredText,recruiter:requiredText,region:requiredText,cv:requiredText,email:{required:requiredText,validEmail:invalidEmail,remote:uniqueMail},mobile:{required:requiredText,validatePhone:phoneValidText}}})});