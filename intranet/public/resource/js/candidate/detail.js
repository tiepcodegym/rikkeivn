function get2Digis(e){return e<10?"0"+e:e}function showMailContent(e,t){var a=getDom(e,t);if(e==typeMailInterview)for(var r in aryMailLocates){var i=aryMailLocates[r],n="interview_content_"+i,l=CKEDITOR.instances[n];"undefined"==typeof l&&(l=RKfuncion.CKEditor.init([n])[n]),l.setData($(".mail-interview_content_"+i).html())}else if(e==typeMailThanks)for(var r in aryMailThanks){var i=aryMailThanks[r],o="thanks_content",l=CKEDITOR.instances[o];"undefined"==typeof l&&(l=RKfuncion.CKEditor.init([o])[o]),l.setData($(".mail-thanks_"+i).html())}else if(e==typeMailOffer)for(var d=0;d<aryMailOffers.length;d++){var s=aryMailOffers[d],c="offer_content_"+s,m=CKEDITOR.instances[c];"undefined"==typeof m&&(m=RKfuncion.CKEditor.init([c])[c]),m.setData($(".mail-offer_content_"+s).html())}else if(e==typeMailFailInterview)for(var d=0;d<aryMailInterFails.length;d++){var u=aryMailInterFails[d],f="interview_fail_content_"+u,p=CKEDITOR.instances[f];"undefined"==typeof p&&(p=RKfuncion.CKEditor.init([f])[f]),p.setData($(".mail-interview_fail_content_"+u).html())}else{var v=$(".mail-"+a).html(),_=CKEDITOR.instances[a];"undefined"==typeof _&&(_=RKfuncion.CKEditor.init([a])[a]),_.setData(v)}$("#modal-"+a).modal("show")}function showPdf(e){e===typeMailOfferJP?localStorage.getItem("inviteLetterJP_"+candidateId)?CKEDITOR.instances.invite_letter_editor.setData(localStorage.getItem("inviteLetterJP_"+candidateId)):CKEDITOR.instances.invite_letter_editor.setData($(".invite-letter-content-jp").html()):(e===typeMailOfferHH3?$(".invite-letter-content-vn .working-place").html("- "+workingPlaceHH3):e===typeMailOfferHH4?$(".invite-letter-content-vn .working-place").html("- "+workingPlaceHH4):e===typeMailOfferDN?$(".invite-letter-content-vn .working-place").html("- "+workingPlaceDN):e===typeMailOfferHandico&&$(".invite-letter-content-vn .working-place").html("- "+workingPlaceHandico),localStorage.getItem("inviteLetterVN_"+candidateId)?CKEDITOR.instances.invite_letter_editor.setData(localStorage.getItem("inviteLetterVN_"+candidateId)):CKEDITOR.instances.invite_letter_editor.setData($(".invite-letter-content-vn").html())),$("#modal-invite-letter").modal("show"),$("#modal-offer_content").modal("hide")}function closeInviteBody(){$("#modal-invite-letter").modal("hide"),$("#modal-offer_content").modal("show")}function createPdf(e){if(e==typeMailOffer){$(".btn-create-pdf").prop("disabled",!0),$(".btn-create-pdf .fa-refresh").removeClass("hidden");var t=CKEDITOR.instances.invite_letter_editor.getData();$.ajax({url:urlPdfSave,type:"post",dataType:"html",data:{content:t},timeout:3e4,success:function(e){1==parseInt(e)&&($("#load_invite").val("1"),$("#modal-invite-letter").modal("hide"),$("#modal-offer_content").modal("show"),$("#modal-offer_content label.invite-letter-label").html(", "+inviteHtmlGenerate),$(".btn-send-mail-offer").removeClass("hidden"),$(".btn-create-pdf").prop("disabled",!1),$(".btn-create-pdf .fa-refresh").addClass("hidden"),$(".invite-letter-content").html(t))},error:function(e,t,a){"timeout"==t?alert("got timeout"):alert("ajax fail to fetch data")},complete:function(){}})}}function send(e,t,a){var r=$(e),i=r.find(".fa-refresh");i.removeClass("hidden"),r.prop("disabled",!0);var n="",l=getDom(t,a),o={content:CKEDITOR.instances[l].getData(),candidate_id:$("#candidate_id").val().trim(),type:t,candidate_fullname:$("#candidate_fullname").val().trim()};t==typeMailRecruiter?(o.candidate_email=$("#recruiter_email").val().trim(),o.mail_title=$("#mail-title").val(),o["related_ids[]"]=$("#recruit_related").val()):o.candidate_email=$("#candidate_email").val().trim(),$.ajax({url:urlMailOffer,type:"post",dataType:"html",data:o,timeout:3e4,success:function(e){1===JSON.parse(e).success?(n=mailSuccessText,$("#modal-notification").removeClass("modal-warning").addClass("modal-success"),$("#modal-interview_content").modal("hide")):0===JSON.parse(e).success?(n=mailSentText,$("#modal-notification").removeClass("modal-success").addClass("modal-warning")):(n=mailFailText,$("#modal-notification").removeClass("modal-success").addClass("modal-warning")),$("#modal-notification .modal-body").html(n),$("#modal-notification").modal("show"),$("#modal-mail-offer-confirm").modal("hide"),$(".mail-"+l).html(o.content),$("#load_invite").val("0"),$("#modal-"+l).modal("hide");var t=userNameCurrent+" ("+emailCurrent+") ";$("div.cmt-wrapper strong.cmt-created_by").text(t),$("div.cmt-wrapper span.cmt-created_at").text(JSON.parse(e).created_at),$("div.cmt-wrapper .comment").text(JSON.parse(e).content);var a=$(".cmt-wrapper").html();$(".grid-data-query-table").prepend(a);var r=jQuery.Event("keypress");r.keyCode=$.ui.keyCode.ENTER,$('input[name="page"]').val(1).trigger(r)},error:function(e,t,a){"timeout"==t?alert("got timeout"):alert("ajax fail to fetch data")},complete:function(){i.addClass("hidden"),r.prop("disabled",!1),"mail_fail_interview"==a&&submitInterview()}})}function sendMail(e,t,a){var r=getDom(t,a);if(t==typeMailRecruiter){var i=$("#mail-title").val();if(!i)return setRequiredContent(mailTitleRequired),!1}var n=CKEDITOR.instances[r].document.getBody().getChild(0).getText().trim();if(!n)return setRequiredContent(mailFailRequiredText),!1;var l=messageConfirm(t);$("#modal-mail-offer-confirm .modal-body").html(l),$("#modal-mail-offer-confirm .btn-send").attr("onclick","send(this, "+t+("undefined"!=typeof a?', "'+a+'"':"")+")"),$("#modal-mail-offer-confirm").modal("show");var o=$("body").find("input[name='mail_offer']:checked").val();o==typeMailOfferJP?localStorage.removeItem("inviteLetterJP_"+candidateId):localStorage.removeItem("inviteLetterVN_"+candidateId)}function setRequiredContent(e){var t=e;$("#modal-notification").removeClass("modal-success").addClass("modal-warning"),$("#modal-notification .modal-body").html(t),$("#modal-notification").modal("show"),$btnSend.prop("disabled",!1),$refresh.addClass("hidden")}function messageConfirm(e){var t="";return e==typeMailOffer&&(teamId||(t+="<p>- Ứng viên chưa có team.</p>"),startWorking||(t+="<p>- Ứng viên chưa có ngày bắt đầu làm việc.</p>")),t+="<p>Bạn chắc chắn muốn gửi mail?</p>"}function getDom(e,t){if("undefined"==t&&(t=""),"mail_interview"==t)return"interview_content"+(e==typeMailInterview?"":"_"+e);if("mail_offer"==t)return"offer_content"+(e==typeMailOffer?"":"_"+e);if("mail_fail_interview"==t)return"interview_fail_content"+(e==typeMailFailInterview?"":"_"+e);if("mail_thanks"==t)return"thanks_content"+(e==typeMailThanks?"":"_"+e);switch(e){case typeMailTest:return"test_content";case typeMailRecruiter:return"recruiter_content";default:return""}}function collapseOfferResult(){var e=$("#offer_result option:selected").val();e==offerPassValue||1==employeeValidErrors&&e==offerPassValue?offerPassCollapse.collapse("show"):offerPassCollapse.collapse("hide")}function sendMailTks(e,t,a,r){var i=$(e),n=i.find(".fa-refresh"),l=i.find(".fa-check");n.removeClass("hidden"),i.prop("disabled",!0),$.ajax({url:urlMailThanks,type:"post",dataType:"html",data:{toEmail:t,toName:a,candidateId:r},timeout:3e4,success:function(e){$(".modal-success").modal("show"),l.removeClass("hidden")},error:function(e,t,a){"timeout"==t?alert("got timeout"):alert("ajax fail to fetch data"),i.prop("disabled",!1)},complete:function(){n.addClass("hidden")}})}function submitInterview(){$("#form-interview-candidate").submit()}function submitInterviewClick(){if($("#interview_result").val()==resultFail&&!lastSendInterviewFail&&$("#chk_interviewer").val()&&$("#chk_request").val())return showMailContent(typeMailFailInterview,"mail_fail_interview"),!1;if($("#interview_result").val()!=offerDefaultValue||!$("#chk_request").val()||!$("#chk_interviewer").val())return submitInterview(),!1;var e=$("#modal-calendar-confirm");e.modal("show"),calendarId&&eventId?e.find(".modal-body").html(messageUpdateCalendarConfirm):e.find(".modal-body").html(messageCreateCalendarConfirm)}function noShowFormCalendar(){$("#modal-calendar-confirm").modal("hide"),$("#form-interview-candidate").submit()}function showFormCalendar(){$("#modal-calendar-confirm").modal("hide"),$("#modal-calendar-create").modal("show"),showCalendars(!0)}function callApiRicode(e,t){if("function"!=typeof $("#form-ricode-test").valid||!$("#form-ricode-test").valid())return!1;var a=parseInt($(".input-ricode input[name=level_easy]").val()),r=parseInt($(".input-ricode input[name=level_medium]").val()),i=parseInt($(".input-ricode input[name=level_hard]").val());if(a=a?a:0,r=r?r:0,i=i?i:0,a+r+i<1)return $("#message-ricode").html('<div class="alert alert-error" role="alert">'+minTotalEasyMediumHard+"</div>"),!1;var n=$("#form-ricode-test").attr("action"),l=$("#form-ricode-test .modal-footer button");l.attr("disabled",!0),$.ajax({type:"post",url:n,data:$("#form-ricode-test").serialize()+"&type="+t,success:function(e){e=JSON.parse(e),l.attr("disabled",!1);var a="",r="";switch(e.status){case 200:if(a="create"===t?createSuccess:updateSuccess,r="success",e&&e.data&&e.data.password){var i=$("#email-candidate").text(),n=$("input[name=ricode_app_url]").val();$("#password-candidate-gen").html("                            <div>                                 <p><a target='_blank' href="+n+">Account login ricode rikkei</a></p>                                 <p><b>Username:</b> "+i+"</p>                                 <p><b>Password:</b> "+e.data.password+"</p>                             </div>                         ")}$("#form-ricode-test .modal-footer button").attr("name","action-is-update"),$("#create-ricode-test").text("Recreate");break;case 12003:a=errorEasyMax,r="error";break;case 12004:a=errorMediumMax,r="error";break;case 12005:a=errorHardMax,r="error";break;case 5001:a=overtimeTest,r="error"}$("#message-ricode").html('<div class="alert alert-'+r+'" role="alert">'+a+"</div>"),setTimeout(function(){$("#message-ricode").html("")},6e3)},error:function(e){$("#message-ricode").html('<div class="alert alert-error" role="alert">'+SystemError+"</div>"),l.attr("disabled",!1)}})}function formatState(e){return e.id?$('<span><i class="fa fa-star-o '+$(e.element).attr("class")+'"></i> '+e.text+"</span>"):e.text}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="_token"]').attr("content")}}),$(document).ready(function(){CKEDITOR.config.height=400,editorInviteLetter=CKEDITOR.replace("invite_letter_editor"),editorInviteLetter.on("change",function(){var e=CKEDITOR.instances.invite_letter_editor.getData(),t=$("body").find("input[name='mail_offer']:checked").val(),a="inviteLetterVN_"+candidateId;t==typeMailOfferJP&&(a="inviteLetterJP_"+candidateId),localStorage.setItem(a,e)})}),$(document).ready(function(){function e(e,t){return parseInt(t)?e:e<10?"000000"+e:e<100?"00000"+e:e<1e3?"0000"+e:e<1e4?"000"+e:e<1e5?"00"+e:e<1e6?"0"+e:""+e}function t(e){e=parseInt(e),$(".group-contract").each(function(){var t=$(this).data("contract")||[];t.indexOf(e)>-1?($(this).removeClass("hidden"),$(this).find("input").prop("disabled",!1)):($(this).addClass("hidden"),$(this).find("input").prop("disabled",!0))})}function a(){return 3!=$("#working_type").val()&&6!=$("#working_type").val()}var r=$("#start_working_date"),i=$("#trial_work_start_date"),n=$("#trial_work_end_date"),l=$("#test_plan"),o=$("#interview_plan"),d=$("#interview2_plan"),s=$("#official_date"),c=$("#working_type"),m={};m[workingTypeBorrow]=outsourcingStartDate,m[workingTypeSeasonal]=seasonalStartDate,m[workingTypeProbation]=trialStartDate+' <em class="required" aria-required="true">*</em>';var u={};u[workingTypeBorrow]=outsourcingEndDate,u[workingTypeSeasonal]=seasonalEndDate,u[workingTypeProbation]=trialEndDate+' <em class="required" aria-required="true">*</em>',RKfuncion.keepStatusTab.init(),jQuery.validator.addMethod("validateTestMark",function(e){var t=parseInt($("#test_result").val());if(0==t)return!0;if(t==parseInt(resultFail)){var a=$("#test_date").val().trim();if(!a)return!0;if(e.trim())return!0}else if(e.trim())return!0;return!1},requiredText),$.validator.addMethod("testDateRequired",function(e){var t=$.trim($("#test_mark").val()),a=parseInt($("#test_result").val());return!((t||a==resultPass)&&!e)}),$.validator.addMethod("rikkeiEmailFormat",function(e,t,a){if(a){var r=/@rikkeisoft.com$/.test(e);return r}return!0}),jQuery.validator.addMethod("greaterThan",function(e,t,a){return!e||!$(a).val()||(this.optional(t)||e>=$(a).val())},errorStartDateBefore),$(".date").datetimepicker({format:"YYYY-MM-DD H:mm"}),$("#start_working_date_interview").datetimepicker({format:"YYYY-MM-DD H:mm"}),l.datetimepicker({format:"YYYY-MM-DD H:mm"}),o.datetimepicker({format:"YYYY-MM-DD H:mm"}),d.datetimepicker({format:"YYYY-MM-DD H:mm"}),$(".field-date-picker").each(function(){$(this).attr("autocomplete","off");var e=$(this).data("format")||"YYYY-MM-DD";$(this).datetimepicker({format:e,useCurrent:!1})}),$("#form-test-candidate").validate({rules:{test_mark:{validateTestMark:!0},test_mark_specialize:{validateTestMark:!0},test_plan:{testDateRequired:!0}},messages:{test_mark:{validateTestMark:requiredText},test_mark_specialize:{validateTestMark:requiredText},test_plan:{testDateRequired:requiredText}},highlight:function(e){var t=$(e).closest(".input-group");t.length>0&&(e=t),$(e).addClass("field-error")},unhighlight:function(e){var t=$(e).closest(".input-group");t.length>0&&(e=t),$(e).removeClass("field-error")}}),$("#interviewer").change(function(){var e=$(this).val();null==e?$("#chk_interviewer").val(""):($("#chk_interviewer").val(1),$("#chk_interviewer-error").remove())}),$("#candidate_request").change(function(){var e=$(this).val();null==e?$("#chk_request").val(""):($("#chk_request").val(1),$("#chk_request-error").remove())}),$("#form-interview-candidate").validate({rules:{chk_interviewer:"required",chk_request:"required"},messages:{chk_interviewer:requiredText,chk_request:requiredText}});var f={request_id:{valueNotEquals:requiredText},team_id:{valueNotEquals:requiredText},position_apply:{valueNotEquals:requiredText},working_type:{valueNotEquals:requiredText},contract_length:{required:requiredText},programming_language_id:{valueNotEquals:requiredText},trial_work_start_date:{greaterThan:errorTrialStartDateBefore},trial_work_end_date:{greaterThan:errorTrialEndDateBefore},official_date:{greaterThan:errorOfficialDateBefore}},p={request_id:{valueNotEquals:"0"},team_id:{valueNotEquals:"0"},position_apply:{valueNotEquals:"0"},programming_language_id:{valueNotEquals:function(){return $("#position_apply").val()==idPosDev?($("#programming_language_required").removeClass("hidden"),"0"):($("#programming_language_required").addClass("hidden"),"")}},start_working_date:{required:function(){return $("#offer_result option:selected").val()!=resultFail}},trial_work_start_date:{required:function(){return $("#offer_result option:selected").val()!=resultFail}},trial_work_end_date:{required:function(){return $("#offer_result option:selected").val()!=resultFail}},working_type:{valueNotEquals:"0"},contract_length:{required:function(){return $("#working_type").val()!=workingTypeUnlimit}},offer_date:{required:function(){return $("#offer_result").val()!=resultFail}},offer_feedback_date:{required:function(){return $("#offer_result").val()!=resultFail}},trainee_start_date:{required:function(){return $("#offer_result").val()!=resultFail&&$("#offer_result").val()!=resultFail}},trainee_end_date:{required:function(){return $("#offer_result").val()!=resultFail&&$("#offer_result").val()!=resultFail},greaterThan:"#trainee_start_date"},official_date:{required:function(){return $("#offer_result").val()!=resultFail}}};$("#position_apply").on("change",function(){$(this).val()==idPosDev?($("#programming_language_id").rules("add",{valueNotEquals:"0"}),$("#programming_language_required").removeClass("hidden")):($("#programming_language_id").rules("remove","valueNotEquals"),$("#programming_language_required").addClass("hidden"))}),$("#form-offering-candidate").validate({messages:f,rules:p}),$("#form-offering-candidate").find("input").on("dp.change",function(){$("#form-offering-candidate").valid()}),$("#form-offering-candidate").find("input, select").on("change",function(){$("#form-offering-candidate").valid()}),$("#employee_card_id").keyup(function(){$("#employee_code").next("#employee_code-error").remove();var t=empCodePrefix+e($(this).val(),isExtraEmpCode);null===t.match(new RegExp(prefixPartner,"g"))&&(t=t.substr(0,10)),$("#employee_code").text(t),$('input[name="employee_code"]').val(t)}),$('#form-employee-candidate select[name="status"]').change(function(){var e=$('#form-employee-candidate select[name="status"]').val()||0;11===parseInt(e)?$("#box-contract-team").show():$("#box-contract-team").hide();var t=$(this).val();$lbCardNum=$('label[data-label="id_card_number"]'),$lbCardDate=$('label[data-label="id_card_date"]'),$lbCardPlace=$('label[data-label="id_card_place"]'),$lbCardAddress=$('label[data-label="native_addr"]'),$lbEmail=$('label[data-label="email"]'),$lbCard=$('label[data-label="employee_card_id"]'),$lbCode=$('label[data-label="employee_code"]'),""==t||t==statusFail?($lbCardNum.removeClass("required-text"),$lbCardDate.removeClass("required-text"),$lbCardPlace.removeClass("required-text"),$lbCardAddress.removeClass("required-text"),$lbEmail.removeClass("required-text"),$lbCard.removeClass("required-text"),$lbCode.removeClass("required-text"),$("#form-employee-candidate .error").remove()):($lbCardNum.addClass("required-text"),$lbCardDate.addClass("required-text"),$lbCardPlace.addClass("required-text"),$lbCardAddress.addClass("required-text"),$lbEmail.addClass("required-text"),$lbCard.addClass("required-text"),$lbCode.addClass("required-text"))}),$("#form-employee-candidate").validate({ignore:"",rules:{status:"required",contract_team_id:{required:function(){var e=$('#form-employee-candidate select[name="status"]').val()||0;return parseInt(e)===statusPreparing}},"employee[email]":{required:function(){var e=$('#form-employee-candidate select[name="status"]').val()||0;return($("#offer_result").val()==offerWorkingValue||$("#offer_result").val()==offerPassValue)&&jQuery.inArray(parseInt(e),[statusPreparing,statusWorking])!==-1},rikkeiEmailFormat:function(){var e=$('#form-employee-candidate select[name="status"]').val()||0;return!$("#is_old_member").is(":checked")&&jQuery.inArray(parseInt(e),[statusPreparing,statusWorking])!==-1},email:!0},"employee[id_card_number]":{required:function(){var e=$('#form-employee-candidate select[name="status"]').val()||0;return($("#offer_result").val()==offerWorkingValue||$("#offer_result").val()==offerPassValue)&&jQuery.inArray(parseInt(e),[statusPreparing,statusWorking])!==-1}},"employee[id_card_date]":{required:function(){var e=$('#form-employee-candidate select[name="status"]').val()||0;return($("#offer_result").val()==offerWorkingValue||$("#offer_result").val()==offerPassValue)&&jQuery.inArray(parseInt(e),[statusPreparing,statusWorking])!==-1}},"employee[id_card_place]":{required:function(){var e=$('#form-employee-candidate select[name="status"]').val()||0;return($("#offer_result").val()==offerWorkingValue||$("#offer_result").val()==offerPassValue)&&jQuery.inArray(parseInt(e),[statusPreparing,statusWorking])!==-1}},"employee[contact][native_addr]":{required:function(){var e=$('#form-employee-candidate select[name="status"]').val()||0;return($("#offer_result").val()==offerWorkingValue||$("#offer_result").val()==offerPassValue)&&jQuery.inArray(parseInt(e),[statusPreparing,statusWorking])!==-1}},"employee[employee_card_id]":{required:function(){var e=$('#form-employee-candidate select[name="status"]').val()||0;return($("#offer_result").val()==offerWorkingValue||$("#offer_result").val()==offerPassValue)&&jQuery.inArray(parseInt(e),[statusPreparing,statusWorking])!==-1},remote:{url:urlcheckExistEmpPropertyValue,type:"post",data:{field:"card_id",candidateid:function(){return $("input[name='candidate_id']").val()},valueid:function(){return $("#employee_card_id").val()},old_employee_id:function(){return $("#emp_old_email").val()?$("#emp_old_email").val():0}},dataFilter:function(e){if(e=JSON.parse(e),1===e.status)return!0;if(0===e.status){if(e.card_id){var t=$("#employee_card_id").siblings(".text-desc").text();t=t.substring(0,t.indexOf(":")+2)+e.card_id,$("#employee_card_id").siblings(".text-desc").text(t)}return!1}}}},old_employee_id:{required:function(){return $("#is_old_member").is(":checked")}}},messages:{"employee[email]":{rikkeiEmailFormat:emailFormat,remote:jQuery.validator.format("Email {0} is already taken.")},"employee[employee_card_id]":{remote:jQuery.validator.format("Employee code is already taken.")}},errorPlacement:function(e,t){"employee[employee_card_id]"===t.attr("name")?e.insertAfter("#employee_code"):e.insertAfter(t)}}),$("#btn_submit_employee").on("click",function(e){var t=$(this),a=t.closest("form"),r=a.valid();if(!r)return e.stopImmediatePropagation(),!1;var i=a.find('select[name="status"]').val(),n=t.data("status"),l="";if(l=n.indexOf(parseInt(i))<0?t.data("other-noti"):t.data("noti"),$("#is_old_member").is(":checked")){var o=[];a.find(".check-change").each(function(){var e=$(this).attr("data-value"),t=$(this).val();if($(this).find("option").length>0&&(t=$(this).find("option:selected").text()),e!=t){var a=$(this).attr("data-title")+": "+(e?e:"NULL")+" --> "+t;o.push(a);var r=$(this).attr("name");"old_employee_id"==r&&o.push(textFieldChangeOldEmp)}}),o.length>0&&(l+="<br /><br />"+o.join("<br />"))}return bootbox.confirm({message:l,className:"modal-warning",buttons:{confirm:{label:confirmYes},cancel:{label:confirmNo}},callback:function(e){e&&(a[0].submit(),t.prop("disabled",!0))}}),!1}),workingType!=workingInternship&&$.inArray(parseInt(workingType),typeNotRequireTrial)===-1||workingType==workingInternship&&($("#email").rules("remove","required"),$("#email").rules("remove","rikkeiEmailFormat"),$("#email").prev().find("em").remove(),$("#employee_card_id").rules("remove","required"),$("#employee_card_id").rules("remove","rikkeiEmailFormat"),$("#employee_card_id").prev().find("em").remove(),$("#start_working_date").rules("remove","required"),$("#start_working_date").parent().parent().prev().find("em").remove()),$("#working_type").change(function(){$("#form-offering-candidate").validate().resetForm();var e=$(this).val();t(e),$("#trial_work_start_date").closest(".form-group").children("label").html(m[e]),$("#trial_work_end_date").closest(".form-group").children("label").html(u[e]),e==workingInternship||$.inArray(parseInt(e),typeNotRequireTrial)!==-1?e==workingInternship&&($("#email").rules("remove","required"),$("#email").rules("remove","rikkeiEmailFormat"),$("#email").prev().find("em").remove(),$("#employee_card_id").rules("remove","required"),$("#employee_card_id").rules("remove","number"),$("#employee_card_id").prev().find("em").remove(),$("#start_working_date").rules("remove","required"),$("#start_working_date").parent().parent().prev().find("em").remove()):($("#start_working_date").rules("add",{required:function(){return $("#offer_result option:selected").val()!=resultFail}}),0==$("#start_working_date").parent().parent().prev().find("em").length&&$("#start_working_date").parent().parent().prev().append('<em class="required" aria-required="true">*</em>')),e!=workingTypeUnlimit?$("#contract_length").closest("p").find("label em").length<1&&$("#contract_length").closest("p").find("label").append('<em class="required" aria-required="true">*</em>'):$("#contract_length").closest("p").find("label em").remove(),2==$("#working_type").val()?($("#contract_length").val(""),$("#contract_length_wrapper").css({display:"none"})):$("#contract_length_wrapper").css({display:"inline"}),c.val()==workingTypeProbation?(i.rules("add",{greaterThan:"#start_working_date"}),n.rules("add",{greaterThan:"#trial_work_start_date"}),s.rules("add",{greaterThan:"#start_working_date"}),i.rules("add",{required:!0}),i.closest(".form-group").find(".required").removeClass("hidden"),n.rules("add",{required:!0}),n.closest(".form-group").find(".required").removeClass("hidden")):(i.rules("remove","greaterThan"),i.rules("remove","required"),i.closest(".form-group").find(".required").addClass("hidden"),n.rules("remove","greaterThan"),n.rules("remove","required"),n.closest(".form-group").find(".required").addClass("hidden"),s.rules("remove","greaterThan"))}),candidateStatus==offerPassValue?$("#email").rules("add",{remote:{url:urlcheckExistEmpPropertyValue,type:"post",data:{field:"email",candidateid:function(){return $("input[name='candidate_id']").val()},valueid:function(){return $("#email").val()},old_employee_id:function(){return $("#emp_old_email").val()?$("#emp_old_email").val():0}},dataFilter:function(e){if(e=JSON.parse(e),1===e.status)return!0;if(0===e.status){if(e.email){var t=$(".emp-new-email .text-desc").text();t=t.substring(0,t.indexOf(":")+2)+e.email,$(".emp-new-email .text-desc").text(t)}return!1}}}}):$("#email").rules("remove","remote"),r.on("dp.change",function(){a()&&i.val(r.val()).trigger("change")}),i.on("dp.change",function(){if(a()){var e=$(this).val(),t=null;if(e&&""!==e){t=new Date(e);var i=new Date(e);i.setDate(1),i.setMonth(t.getMonth()+3),i.setDate(0),t.getDate()>28&&t.getDate()>i.getDate()?t=i:(t.setMonth(t.getMonth()+2),t.setDate(t.getDate()-1))}else s.is(":disabled")||s.val(r.val()).trigger("change");n.is(":disabled")||n.val(t?t.toDateString():null).trigger("change")}}),n.on("dp.change",function(){if(a()){var e=$(this).val(),t=null;e&&(t=new Date(e),t.setDate(t.getDate()+1)),s.is(":disabled")||s.val(t?t.toDateString():null).trigger("change")}})}),Date.prototype.toDateString=function(){return this.getFullYear()+"-"+get2Digis(this.getMonth()+1)+"-"+get2Digis(this.getDate())},$("input[name=mail_interview]").change(function(){var e=$(this).data("target");$(".container-interview").addClass("hidden"),$("#"+e).parent().removeClass("hidden")}),$("input[name=mail_interview_content]").change(function(){var e=this.value,t=$(this).data("target");$(".container-interview").addClass("hidden"),$("#"+t).parent().removeClass("hidden"),$(".btn-send-mail-interview").attr("onclick","sendMail(this, "+e+', "mail_interview");')}),$("input[name=mail_thanks]").change(function(){var e=this.value,t=$(this).data("target");$(".container-thanks").addClass("hidden"),$("#"+t).parent().removeClass("hidden"),$(".btn-send-mail-thanks").attr("onclick","sendMail(this, "+e+', "mail_thanks");')}),$("input[name=mail_offer]").change(function(){var e=this.value,t=$(this).data("target");$(".container-offer").addClass("hidden"),$("#"+t).parent().removeClass("hidden"),$(".btn-send-mail-offer").attr("onclick","sendMail(this, "+e+', "mail_offer");'),$(".btn-show-pdf").attr("onclick","showPdf("+e+");")}),$("#offer_result").change(function(){var e=$(this).val(),t=".start_working_date-container, .trial_work_end_date-container, .request-container, .teams-container, .pos-container";parseInt(e)==parseInt(resultPass)||parseInt(e)==parseInt(offerWorkingValue)?$(t).removeClass("hidden"):$(t).addClass("hidden")}),$("#btn-test-history").click(function(){$("#test-history-modal").modal("show")}),$("#btn-test-ricode").click(function(){$("#test-ricode-modal").modal("show")}),$(document).ready(function(){$("#test-history-table").DataTable({processing:!0,lengthChange:!1,bFilter:!1,serverSide:!0,ajax:urlTestHistory,pageLength:10,oLanguage:dataLang,order:[[4,"desc"]],columns:[{data:"name",name:"name"},{data:"total_corrects",name:"total_corrects"},{data:"total_answers",name:"total_answers"},{data:"total_questions",name:"total_questions"},{data:"created_at",name:"created_at"},{data:"link",name:"link"}]}),$(document).on("change","select#test_result",function(){$("label[for=test_mark] em.required, label[for=test_plan] em.required").remove(),$("#test_mark-error, #test_mark_specialize-error, #test_plan-error").remove(),$(this).val()==resultPass&&$("label[for=test_mark], label[for=test_plan]").append(htmlRequired)}),2==$("#working_type > option:selected").val()&&($("#contract_length").val(""),$("#contract_length_wrapper").css({display:"none"})),$("#offer_result").change(function(){collapseOfferResult(),$("label.error").remove()}),$('button[type="submit"]:disabled').prop("disabled",!1)}),$("#btn_submit_offer").click(function(e){if($("#offer_result").val()!=offerWorkingValue)return!0;var t=$(this).closest("form");if(!t.valid())return!1;var a=$(this);return a.prop("disabled",!0),$.ajax({type:"GET",url:urlCheckEmpMail,data:{email:t.find("#email").val(),employee_id:t.find("#employee_id").val()},success:function(e){if("1"==e.exists){var a=$("#_modal_confirm");a.find(".text-body").html(e.message),a.modal("show"),a.find(".btn-ok").one("click",function(){t[0].submit()})}else t[0].submit()},complete:function(){a.prop("disabled",!1)}}),!1}),$(document).on("click","#modal-interview_fail_content .pull-left",function(){submitInterview()}),select2Employees("#interviewer"),$(document).on("click",".edit-comment",function(e){e.preventDefault();var t=$(this).attr("data-content"),a=$(this).attr("data-id");$(".info-comment").removeClass("hidden"),$(".button-action").addClass("hidden"),$(".key_enter_submit_candidate").val(t),$("input[name=comment_id]").attr("value",a),$("#candidate_comment_submit").css("display","none"),$("#candidate_comment_save").css("display","block"),$(".key_enter_submit_candidate").css("box-shadow","4px 4px 4px #666"),$(".key_enter_submit_candidate").focus(),formCandidateValid.resetForm()}),$(document).on("click","#candidate_comment_save",function(e){e.preventDefault();var t=$(".key_enter_submit_candidate").val();t?($(".key_enter_submit_candidate").css("box-shadow","none"),$(".key_enter_submit_candidate").submit(),$("input[name=comment_id]").attr("value",""),$("#candidate_comment_submit").css("display","block"),$("#candidate_comment_save").css("display","none"),$(".info-comment").addClass("hidden")):$("#comment-error").removeClass("hidden")}),$(document).on("keyup",".key_enter_submit_candidate",function(e){if(27===e.keyCode){var t=$("input[name=comment_id]");/^\d+$/.test(t.val())&&($(this).val(""),t.attr("value",""),$("#candidate_comment_submit").css("display","block"),$("#candidate_comment_save").css("display","none"),$(".info-comment").addClass("hidden"),$(".key_enter_submit_candidate").css("box-shadow","none"),$(".button-action").removeClass("hidden"),formCandidateValid.resetForm())}}),$(document).on("click",".delete-comment",function(e){e.preventDefault();var t=$(this).attr("data-id");bootbox.confirm({message:deleteCommentCandidateTextConfirm,className:"modal-default",buttons:{cancel:{label:"Cancel",className:"pull-left"}},callback:function(e){e&&$.ajax({method:"POST",url:deleteCommentCandidate,data:{id:t,_token:_token},success:function(e){var t=jQuery.Event("keypress");t.keyCode=$.ui.keyCode.ENTER,$('input[name="page"]').val(1).trigger(t)}})}})}),$("#is_old_member").click(function(e){var t=$(this).is(":checked"),a=$(".emp-new-email"),r=$(".emp-old-email"),i=$("#emp_old_email");t?(a.addClass("hidden"),r.removeClass("hidden")):(a.removeClass("hidden"),r.addClass("hidden"),i.val("").trigger("change"))}),$("#emp_old_email").change(function(){var e=$(this),t=e.data("change-url"),a=e.val(),r=e.closest("form");a&&!e.hasClass("loading")&&$.ajax({type:"POST",url:t,data:r.serialize()+"&employee_id="+a+"&_token="+r.find('[name="_token"]').val(),success:function(e){$.each(e,function(e,t){var a=r.find('[name*="'+e+'"]');a.val(t),a.hasClass("select-search")&&a.trigger("change"),"employee_card_id"==e&&a.trigger("keyup"),r.valid()}),$("#employee_id").val(a)},error:function(t){e.val("").trigger("change"),$("#employee_id").val(""),bootbox.alert({message:t.responseJSON,className:"modal-danger"})},complete:function(){e.removeClass("loading")}})}),$(document).on("click",".input-group-edit .btn-toggle-edit",function(e){e.preventDefault();var t=$(this).attr("data-title-edit"),a=$(this).attr("data-title-disable"),r=$(this).closest(".input-group").find(".form-control"),i=$(this).closest(".input-group").find(".multiselect").length>0;r.is(":disabled")?(r.prop("disabled",!1).trigger("change"),i&&r.multiselect("enable"),$(this).find("span").text(a),$(this).removeClass("btn-primary").addClass("btn-warning")):(r.prop("disabled",!0).trigger("change"),
i&&r.multiselect("disable"),$(this).find("span").text(t),$(this).removeClass("btn-warning").addClass("btn-primary"))}),$("#form-ricode-test").submit(function(){return!1});var formRicodeTest=$("#form-ricode-test").validate({rules:{level_easy:{digits:!0},level_medium:{digits:!0},level_hard:{digits:!0},duration:{required:!0,digits:!0,min:1}},messages:{level_easy:{digits:isDigits},level_medium:{digits:isDigits},level_hard:{digits:isDigits},duration:{required:requiredText,digits:isDigits,min:minDuration}}});$("#create-ricode-test").click(function(e){e.preventDefault(),callApiRicode($(this),"create")}),$("#update-ricode-test").click(function(e){e.preventDefault(),callApiRicode($(this),"update")}),$("select[name='interested']").select2({templateResult:formatState,templateSelection:formatState}),$(document).on("change","#contact_result, #test_result, #interview_result, #offer_result",function(){var e=$(this).closest("form").find(".interested-input-container");$(this).val()===resultFail?e.removeClass("hidden"):e.addClass("hidden")}),$(document).on("change",".employee-status",function(){var e=$(this).closest("form").find(".interested-input-container");$(this).val()===statusFail+""?e.removeClass("hidden"):e.addClass("hidden")});