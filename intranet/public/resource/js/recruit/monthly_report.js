var $modalChangeColor=$("#modal-change-color"),$bodyModal=$modalChangeColor.find(".modal-body"),$form=$bodyModal.children("form"),$inputColor=$form.find('input[name="color"]'),$btnSave=$modalChangeColor.find(".btn-save"),_token=$form.find('input[name="_token"]').val(),$channelId=$form.find('input[name="channelId"]');$(".column-choice").select2(),$inputColor.colorpicker({format:"hex"}).focusin(function(){$bodyModal.css("min-height","220px")}).focusout(function(){setTimeout(function(){$bodyModal.css("min-height","")},100)}),RKfuncion.general.initDateTimePicker(),$(".input-datepicker").on("dp.change",function(){$(".btn-search-filter").click()}),$('input[name="display_type"]').on("click",function(){var a=$(".tab-data-table"),t=$(".tab-chart");"chart"===$(this).val()?(a.addClass("hidden"),t.removeClass("hidden")):(a.removeClass("hidden"),t.addClass("hidden"))}),Array.isArray(recruiters)||(recruiters=Object.keys(recruiters).map(function(a){return recruiters[a]}));var recruiterNames=recruiters.map(function(a){return a.name}),dataChartInterviewFail=[],dataChartInterviewPass=[],dataChartInterviewOffer=[],bgColorDefault="#ffff00";Object.keys(groupChannels).map(function(a,t){dataChartInterviewFail[t]={label:groupChannels[a].name,data:[],backgroundColor:groupChannels[a].color||bgColorDefault},dataChartInterviewPass[t]={label:groupChannels[a].name,data:[],backgroundColor:groupChannels[a].color||bgColorDefault},dataChartInterviewOffer[t]={label:groupChannels[a].name,data:[],backgroundColor:groupChannels[a].color||bgColorDefault},recruiters.map(function(e,n){var r=groupChannels[a].recruiters[e.email].total,i=groupChannels[a].recruiters[e.email].pass,l=groupChannels[a].recruiters[e.email].fail,o=groupChannels[a].recruiters[e.email].offer;r=r?r:1,dataChartInterviewPass[t].data[n]=(i/r*100).toFixed(2),dataChartInterviewFail[t].data[n]=(l/r*100).toFixed(2),dataChartInterviewOffer[t].data[n]=(o/r*100).toFixed(2)})});var ctxFail=document.getElementById("candidateFail").getContext("2d"),ctxPass=document.getElementById("candidatePass").getContext("2d"),ctxOffer=document.getElementById("candidateOffer").getContext("2d"),chartCandidateFail=new Chart(ctxFail,{type:"bar",data:{labels:recruiterNames,datasets:dataChartInterviewFail},options:{scales:{yAxes:[{ticks:{min:0,max:100,callback:function(a){return a.toFixed(0)+"%"}}}],xAxes:[{ticks:{autoSkip:!1}}]},title:{display:!0,text:txtQuantityCandidateFailInterview,fontSize:16},maintainAspectRatio:!1,legend:{onClick:function(a,t){handleClickChart(t)}},tooltips:{callbacks:{label:function(a,t){var e=t.datasets[a.datasetIndex];return e.label+": "+a.yLabel+"%"}}}}}),chartCandidatePass=new Chart(ctxPass,{type:"bar",data:{labels:recruiterNames,datasets:dataChartInterviewPass},options:{scales:{yAxes:[{ticks:{min:0,max:100,callback:function(a){return a.toFixed(0)+"%"}}}],xAxes:[{ticks:{autoSkip:!1}}]},title:{display:!0,text:txtQuantityCandidatePassInterview,fontSize:16},maintainAspectRatio:!1,legend:{onClick:function(a,t){handleClickChart(t)}},tooltips:{callbacks:{label:function(a,t){var e=t.datasets[a.datasetIndex];return e.label+": "+a.yLabel+"%"}}}}}),chartCandidateOffer=new Chart(ctxOffer,{type:"bar",data:{labels:recruiterNames,datasets:dataChartInterviewOffer},options:{scales:{yAxes:[{ticks:{min:0,max:100,callback:function(a){return a.toFixed(0)+"%"}}}],xAxes:[{ticks:{autoSkip:!1}}]},title:{display:!0,text:txtQuantityCandidatePassOffer,fontSize:16},maintainAspectRatio:!1,legend:{onClick:function(a,t){handleClickChart(t)}},tooltips:{callbacks:{label:function(a,t){var e=t.datasets[a.datasetIndex];return e.label+": "+a.yLabel+"%"}}}}}),handleClickChart=function(a){var t=a.datasetIndex;$modalChangeColor.modal("show"),$inputColor.val(a.fillStyle),$form.find('input[name="channel"]').val(a.text),$channelId.val(selectedChannels[t].id),$btnSave.attr("data-index",t)};$btnSave.click(function(a){a.preventDefault();var t=$btnSave.attr("data-index");$btnSave.children("i").removeClass("hidden"),$.ajax({url:$form.attr("action"),method:"post",data:{_token:_token,channelId:$channelId.val(),color:$inputColor.val()}}).done(function(a){if(a&&1===a.status){var e=$inputColor.val();chartCandidateFail.data.datasets[t].backgroundColor=e,chartCandidateFail.update(),chartCandidatePass.data.datasets[t].backgroundColor=e,chartCandidatePass.update(),chartCandidateOffer.data.datasets[t].backgroundColor=e,chartCandidateOffer.update(),$modalChangeColor.modal("hide"),$btnSave.children("i").addClass("hidden")}})});