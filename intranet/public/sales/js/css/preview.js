function removeError(){$(".inputTags-error").slideUp()}function showModalSuccess(e){var i=$("#modal-success");i.find(".modal-body p").html(e),$("#modal-success").modal("show")}function showModalError(e){var i=$("#modal-error");i.find(".modal-body p").html(e),i.modal("show")}function showModalWarning(e){var i=$("#modal-warning");i.find(".modal-body p").html(e),i.modal("show")}function showModalConfirm(e){var i=$("#modal-confirm");i.find(".modal-body p").html(e),i.modal("show")}function showModalConfirmDelete(e){var i=$("#modal-confirm-delete-email");i.find(".modal-body p").html(e),i.modal("show")}function removeRow(e){$(e).parent().parent().remove(),$(".check").filter(":checked").length==$(".check").length&&($("#check-all").addClass("hidden"),$("#uncheck-all").removeClass("hidden"))}function addError(e){return'<span class="error">'+e+"</span>"}function textLastSend(){$(".customer-email").each(function(){$(this).next("span").remove(),$(this).after("<span>"+lastSendText+getNow()+"</span>")})}function getNow(){var e=new Date,i=e.getFullYear()+"-"+twoDigiss(e.getMonth()+1)+"-"+twoDigiss(e.getDate())+" "+twoDigiss(e.getHours())+":"+twoDigiss(e.getMinutes())+":"+twoDigiss(e.getSeconds());return i}function twoDigiss(e){return("00"+e).substr(-2)}$("input").iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue"}),$(function(){$("#rateit_star").rateit({min:1,max:10,step:2})}),$("#link-make").click(function(){$("#link-make").selectText()}),$(".container-question").each(function(){var e=0;$(this).find(".container-question-child").each(function(){e<$(this).outerHeight()&&(e=$(this).outerHeight())}),$(this).height()<e&&$(this).height(e)}),$("body").on("click",".add-cus",function(){var e=$(".cus-row-container"),i='<div class="cus-row margin-top-10 row cus-row-new"><div class="col-md-1"><input type="checkbox" class="check" /></div><div class="col-md-2"><select class="form-control select-gender" name="select-gender"><option value="1">Mr.</option><option value="0">Ms.</option></select></div><div class="col-md-4"><input type="text" class="form-control col-sm-3 customer-name" placeholder="Customer name"></div><div class="col-md-4"><input type="text" class="form-control col-sm-9 customer-email" placeholder="Email address"></div><div class="col-md-1"><span class="btn-delete delete-x" onclick="removeRow(this);"><i class="fa fa-remove"></i></span></div></div>';e.append(i),$("input").iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue"}),$("#uncheck-all").addClass("hidden"),$("#check-all").removeClass("hidden")}),$("#send-mail").on("click",function(){$(".error").remove();var e=[],i=!0,a=!1;if($(".cus-row").each(function(){var n=$(this).find(".check"),s=$.trim($(this).find(".customer-name").val()),t=$.trim($(this).find(".customer-email").val());""==s&&($(this).find(".customer-name").parent().append(addError(requiredField)),i=!1),""==t?($(this).find(".customer-email").parent().append(addError(requiredField)),i=!1):isEmail(t)||($(this).find(".customer-email").parent().append(addError(email_invalid)),i=!1),""!=t&&(jQuery.inArray(t,e)==-1?(e.push(t),n.length>0&&n.iCheck("update")[0].checked&&(a=!0)):($(this).find(".customer-email").parent().append(addError(email_exist)),i=!1))}),!i)return!1;if(!a)return showModalWarning(checkboxRequired),!1;var n='<label for="exampleFormControlSelect1" class="fs-17">Chọn mail gửi css</label><select class="form-control h-35" id="typeMailSelect1"><option value="0">Chọn mail</option><option value="1">Mail hoàn thành</option><option value="2">Mail định kỳ</option></select><span class="message-select-mail hidden">Yêu cầu chọn kiểu loại mail trước khi gửi.</span>';$("#modal-confirm").find(".modal-body div").html(n),showModalConfirm(sureSendMail)}),$("body").on("click","#check-all",function(){$(".cus-row").each(function(){var e=$(this).find(".check");e.iCheck("check")}),$("#check-all").addClass("hidden"),$("#uncheck-all").removeClass("hidden")}),$("body").on("click","#uncheck-all",function(){$(".cus-row").each(function(){var e=$(this).find(".check");e.iCheck("uncheck")}),$("#uncheck-all").addClass("hidden"),$("#check-all").removeClass("hidden")}),$(document).on("ifChecked",".check",function(){$(".check").filter(":checked").length==$(".check").length&&($("#check-all").addClass("hidden"),$("#uncheck-all").removeClass("hidden"))}),$(document).on("ifUnchecked",".check",function(){$("#uncheck-all").addClass("hidden"),$("#check-all").removeClass("hidden")}),$("#send-mail-confirm").on("click",function(){var e=$("#typeMailSelect1").val();if(0==e)return $(".message-select-mail").removeClass("hidden"),!1;$("#modal-confirm").modal("hide");var i=$("#send-mail"),a=[],n=$(".cus-row .check").length;i.prop("disabled",!0),i.find("i").removeClass("hidden"),$(".cus-row").each(function(){var e=$(this).find(".check"),i=$.trim($(this).find(".customer-name").val()),s=$.trim($(this).find(".customer-email").val()),t=$.trim($(this).find(".select-gender").val());e.length>0&&(e.iCheck("update")[0].checked||1==n)&&a.push([i,s,t])}),$.ajax({url:urlSubmit,type:"post",dataType:"json",data:{_token:token,emails:a,css_id:cssId,typeMail:e}}).done(function(e){i.prop("disabled",!1),showModalSuccess(sendMailSuccess),$("#uncheck-all").addClass("hidden"),$("#check-all").removeClass("hidden"),$('input[type="checkbox"]').removeAttr("checked").iCheck("update"),i.find("span").html(resendText+'<i class="fa fa-spin fa-refresh hidden"></i>'),$(".cus-row-new").each(function(i){var a='<span class="btn-delete"><i class="fa fa-trash"></i></span><input class="id-email-css" type="hidden" name="idEmailCss" value="'+e[i].cssMailId+'" />';$(this).find("input[type=text]").prop("disabled",!0),$(this).find(".select-gender").prop("disabled",!0),$(this).find(".btn-delete.delete-x").parent().addClass("delete-css-email"),$(this).attr("id","item-"+e[i].cssMailId).removeClass("cus-row-new"),$(this).find(".btn-delete.delete-x").after(a),$(this).find(".btn-delete.delete-x").remove()}),textLastSend()}).fail(function(){i.prop("disabled",!1),i.find("span").html(resendText+'<i class="fa fa-spin fa-refresh hidden"></i>')})}),$(".btn-show-hide").click(function(e){var i=e.target;return $("#preview").toggle(500,function(){$(i).html($(this).is(":visible")?hideText:showText)}),!1}),$("body").on("click",".delete-css-email",function(){showModalConfirmDelete(sureDeleteMail);var e=$(this).find(".id-email-css").val();$(".button-confirm-delete").val(e)}),$("#delete-mail-confirm").on("click",function(){$("#modal-confirm-delete-email").modal("hide");var e=$(".button-confirm-delete").val(),i=[];i.push([e]),$.ajax({url:urlSubmitDelete,type:"post",dataType:"json",data:{_token:token,idEmail:i}}),showModalSuccess(deleteMailSuccess),$("#item-"+e).remove()});