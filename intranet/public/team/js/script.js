function fixHeight(){$(".container-question").css("height","auto"),$(".fix-height").css("height","auto"),$(window).width()>=768?$(".container-question").each(function(){var e=0;$(this).find(".fix-height").each(function(){e<$(this).outerHeight()&&(e=$(this).outerHeight())}),$(this).height()<e&&$(this).height(e);var t=$(this).height(),a=$(this).find(".comment").outerHeight();$(this).find(".comment").css("margin-top",(t-a)/2),$(this).find(".fix-height").outerHeight(t)}):($(".container-question").css("height","auto"),$(".fix-height").css("height","auto"))}function hoverHelp(){$(".tooltip-group i.fa-question-circle").hover(function(){$(this).closest(".tooltip-group").find(".tooltip").css({display:"block","z-index":1050,opacity:1,visibility:"visible"})},function(){$(this).closest(".tooltip-group").find(".tooltip").css({display:"none","z-index":1050,opacity:0,visibility:"none"})})}function checkDisplayResponsibleTeam(){var e=[];$(".group-team-position");$('.team-edit select[data-flag-dom="select2"]').each(function(){e.indexOf($(this).val(),0)==-1&&e.push($(this).val())}),e.indexOf("22")===-1?$(".team-responsible").addClass("hidden"):$(".team-responsible").removeClass("hidden")}function getDataProfileBase(e){var t={roles:[],basic:[],teams:[],team_responsible:[],other:[]};return e.map(function(e){var a=e.name||"";return/^employee\[.+\]$/i.test(a)?void(t.basic[a]=e.value):/^team\-responsible\[\]$/i.test(a)?void t.team_responsible.push(e.value):/^team\[.+\]\[.+\]$/i.test(a)?void(t.teams[a]=e.value):/^role\[\]$/i.test(a)?void t.roles.push(e.value):void(t.other[a]=e.value)}),t}function compareObjects(e,t){var a,n,i,r,o=Object.keys(e),l=o.length;if(l!==Object.keys(t).length)return!1;for(n=0;n<l;n++)if(a=o[n],i=e[a],r=t[a],!($.isArray(i)&&$.isArray(r)&&(i.sort(),r.sort(),JSON.stringify(i)===JSON.stringify(r))||i===r))return!1;return!0}!function(e,t,a,n,i){function r(){e("#business_trip_tbl .date-picker").datetimepicker({format:"YYYY-MM-DD"})}var o="object"==typeof globalPassModule?globalPassModule:{},l="object"==typeof o.trans?o.trans:{},s={};"function"==typeof e().datetimepicker&&(e('input[data-flag-type="date"]').datetimepicker({format:"YYYY-MM-DD",useCurrent:!1}),e('input[data-flag-type="date-year"]').datetimepicker({format:"YYYY",useCurrent:!1}));for(var d={dom:e("#form-employee-info"),validate:function(){var e=this;return!!e.dom.length&&void e.dom.validate({ignore:"",rules:e.rule(e.dom.data("valid-type")),lang:"vi",messages:m,errorPlacement:function(e,t){t.hasClass("select-search")?e.appendTo(t.closest(".input-box")):e.insertAfter(t)}})},rule:function(){switch(o.tabType){case"work":return{"employee[employee_code]":{required:!0,maxlength:function(e){if(!e.value.includes("Partner_"))return 10}},"employee[employee_card_id]":{number:!0,maxlength:10},"employee[email]":{required:!0,email:!0,maxlength:100},"employee[join_date]":{required:!0},"employee[offcial_date]":{greaterEqualThan:'[name="employee[join_date]"]'},"employee[trial_date]":{greaterEqualThan:'[name="employee[join_date]"]'},"employee[trial_end_date]":{greaterEqualThan:['[name="employee[join_date]"]','[name="employee[trial_date]"]']},"employee[leave_date]":{greaterEqualThan:'[name="employee[join_date]"]'},"employee[leave_reason]":{maxlength:5e3},"e_w[tax_code]":{maxlength:255},"e_w[bank_account]":{maxlength:255},"e_w[bank_name]":{maxlength:255},"e_w[insurrance_book]":{maxlength:255},"e_w[insurrance_ratio]":{number:!0,maxlength:6},"e_w[insurrance_h_code]":{maxlength:255},"e_w[register_examination_place]":{maxlength:255},"e_w[insurrance_date]":{},"e_w[insurrance_h_expire]":{}};case"contact":return{"employeeContact[mobile_phone]":{required:!0,maxlength:20},"employeeContact[office_phone]":{maxlength:20},"employeeContact[home_phone]":{maxlength:20},"employeeContact[other_phone]":{maxlength:20},"employeeContact[personal_email]":{email:!0,maxlength:100},"employeeContact[other_email]":{email:!0,maxlength:100},"employeeContact[yahoo]":{maxlength:100},"employeeContact[skype]":{maxlength:100},"employeeContact[facebook]":{maxlength:100},"employeeContact[native_addr]":{maxlength:255},"employeeContact[native_province]":{maxlength:100},"employeeContact[native_district]":{maxlength:100},"employeeContact[native_ward]":{maxlength:100},"employeeContact[tempo_addr]":{maxlength:255},"employeeContact[tempo_province]":{maxlength:100},"employeeContact[tempo_district]":{maxlength:100},"employeeContact[tempo_ward]":{maxlength:100},"employeeContact[emergency_contact_name]":{maxlength:100},"employeeContact[emergency_mobile]":{maxlength:20},"employeeContact[emergency_contact_mobile]":{maxlength:20},"employeeContact[emergency_addr]":{maxlength:255}};case"health":return{"employeeHealth[height]":{number:!0,maxlength:6},"employeeHealth[weigth]":{number:!0,maxlength:6},"employeeHealth[health_status]":{maxlength:255},"employeeHealth[health_note]":{maxlength:5e3},"employeeHealth[ailment]":{maxlength:5e3}};case"hobby":return{"employeeHobby[hobby_content]":{required:!0,maxlength:5e3,normalizer:function(t){return e.trim(t)}},"employeeHobby[personal_goal]":{maxlength:5e3},"employeeHobby[forte]":{maxlength:5e3},"employeeHobby[hobby]":{maxlength:5e3},"employeeHobby[weakness]":{maxlength:5e3}};case"costume":return{"employeeCostume[asia_shirts]":{required:!0},"employeeCostume[euro_shirts]":{required:!0},"employeeCostume[shoudler_width]":{number:!0,maxlength:8},"employeeCostume[round_butt]":{number:!0,maxlength:8},"employeeCostume[long_sleeve]":{number:!0,maxlength:8},"employeeCostume[long_pants]":{number:!0,maxlength:8},"employeeCostume[long_shirt]":{number:!0,maxlength:8},"employeeCostume[long_skirt]":{number:!0,maxlength:8},"employeeCostume[round_chest]":{number:!0,maxlength:8},"employeeCostume[round_thigh]":{number:!0,maxlength:8},"employeeCostume[round_waist]":{number:!0,maxlength:8}};case"politic":return{"employeePolitic[party_join_date]":{date:!0},"employeePolitic[union_join_date]":{date:!0},"employeePolitic[party_join_place]":{maxlength:255},"employeePolitic[union_join_place]":{maxlength:255}};case"military":return{"employeeMilitary[branch]":{maxlength:255},"employeeMilitary[left_reason]":{maxlength:255},"employeeMilitary[num_disability_rate]":{number:!0,max:100,min:0,maxlength:8},"employeeMilitary[left_date]":{greaterEqualThan:'[name="employeeMilitary[join_date]"]'}};case"japaninfo":return{"employeeJapan[from]":{date:!0},"employeeJapan[to]":{date:!0,greaterEqualThan:'[name="employeeJapan[from]"]'},"employeeJapan[note]":{maxlength:5e3}};case"prize":return{"employeeItemPrize[name]":{required:!0,maxlength:255},"employeeItemPrize[level]":{maxlength:255},"employeeItemPrize[issue_date]":{required:!0,date:!0},"employeeItemPrize[expire_date]":{date:!0,greaterEqualThan:'[name="employeeItemPrize[issue_date]"]'},"employeeItemPrize[place]":{maxlength:255},"employeeItemPrize[place]":{maxlength:5e3}};case"relationship":return{"relative[name]":{required:!0,maxlength:255},"relative[id_number]":{maxlength:100},"relative[mobile]":{maxlength:20},"relative[tel]":{maxlength:20},"relative[address]":{maxlength:255},"relative[email]":{email:!0,maxlength:100},"relative[tax_code]":{maxlength:100},"relative[career]":{maxlength:255},"relative[working_place]":{maxlength:255},"relative[note]":{maxlength:5e3},"relative[deduction_start_date]":{date:!0},"relative[deduction_end_date]":{date:!0,greaterEqualThan:'[name="relative[deduction_start_date]"]'}};case"docexpire":return{"doc[name]":{required:!0,maxlength:255},"doc[place]":{required:!0,maxlength:255},"doc[issue_date]":{required:!0,date:!0},"doc[expired_date]":{required:!0,date:!0,greaterEqualThan:'[name="doc[issue_date]"]'},"doc[note]":{maxlength:5e3}};case"attach":return{attach_as:{required:!0},"attach[title]":{required:!0,maxlength:255},"attach[note]":{maxlength:5e3}};case"skill":return{"skill[type]":{required:!0,maxlength:255},"skill[name]":{required:!0},"skill[level]":{required:!0},"skill[experience]":{required:!0,maxlength:255,ifNumberThenPositive:!0}};case"education":return{"edu[school_id]":{required:!0},"edu[start_at]":{required:!0,date:!0},"edu[end_at]":{date:!0,greaterEqualThan:'[name="edu[start_at]"]'},"edu[country]":{required:!0,maxlength:50},"edu[province]":{required:!0,maxlength:255},"edu[faculty_id]":{required:!0},"edu[major_id]":{required:!0},"edu[quality]":{required:!0},"edu[type]":{required:!0},"edu[awarded_date]":{date:!0,greaterEqualThan:'[name="edu[start_at]"]'},"edu[note]":{maxlength:5e3}};case"certificate":return{"cer[certificate_id]":{required:!0,maxlength:255},"cer[level_other]":{maxlength:255},"cer[place]":{required:!0,maxlength:255},"cer[start_at]":{date:!0},"cer[end_at]":{date:!0,greaterEqualThan:'[name="cer[start_at]"]'},"cer[p_listen]":{number:!0,min:0,maxlength:8},"cer[p_speak]":{number:!0,min:0,maxlength:8},"cer[p_read]":{number:!0,min:0,maxlength:8},"cer[p_write]":{number:!0,min:0,maxlength:8},"cer[p_sum]":{maxlength:255},"cer[note]":{maxlength:5e3},"certificate_image[]":{required:function(){var t=0;return e("#image_preview .imgPreviewWrap").each(function(){t++}),!(t>1)}}};case"comexper":return{"com[name]":{required:!0,maxlength:255},"com[position]":{required:!0,maxlength:255},"com[address]":{required:!0,maxlength:255},"com[start_at]":{date:!0},"com[end_at]":{date:!0,greaterEqualThan:'[name="com[start_at]"]'}};case"experience":return{"exp[name]":{required:!0,maxlength:255},"exp[position]":{required:!0,maxlength:255},"exp[customer]":{maxlength:255},"exp[start_at]":{date:!0},"exp[end_at]":{date:!0,greaterEqualThan:'[name="exp[start_at]"]'},"exp[no_member]":{digits:!0,maxlength:4},"exp[env]":{maxlength:255},"exp[other_tech]":{maxlength:5e3},"exp[implement]":{maxlength:5e3},"exp[description]":{maxlength:5e3},"ex_mo[per_y]":{digits:!0,max:100},"ex_mo[per_m]":{digits:!0,max:12}};case"wonsite":return{"ons[place]":{required:!0,maxlength:255},"ons[start_at]":{required:!0,date:!0},"ons[end_at]":{date:!0,greaterEqualThan:'[name="ons[start_at]"]'},"ons[reason]":{maxlength:5e3},"ons[note]":{maxlength:5e3}};default:return c}}},m={"employee[passport_date_exprie]":{greaterEqualThan:l.base_passport_greater},"employee[offcial_date]":{greaterEqualThan:l.offical_greater},"employee[trial_date]":{greaterEqualThan:l.trial_greater},"employee[trial_end_date]":{greaterEqualThan:l.trial_end_greater},"employee[leave_date]":{greaterEqualThan:l.leave_greater},"employeeJapan[to]":{greaterEqualThan:l.work_japan_to_greater},"employeeItemPrize[expire_date]":{greaterEqualThan:l.prize_expire_greater},"relative[deduction_end_date]":{greaterEqualThan:l.relative_deduction_greater},"employeeMilitary[left_date]":{greaterEqualThan:l.military_left_greater},"doc[expired_date]":{greaterEqualThan:l.doc_expired_greater},"edu[end_at]":{greaterEqualThan:l.edu_end_greater},"edu[awarded_date]":{greaterEqualThan:l.edu_end_greater},"cer[end_at]":{greaterEqualThan:l.cer_end_greater},"cer[p_listen]":{min:l.positive_equal0},"cer[p_speak]":{min:l.positive_equal0},"cer[p_read]":{min:l.positive_equal0},"cer[p_write]":{min:l.positive_equal0},"skill[experience]":{ifNumberThenPositive:l.positive},"com[end_at]":{greaterEqualThan:l.edu_end_greater},"exp[end_at]":{greaterEqualThan:l.exp_end_greater},"ons[end_at]":{greaterEqualThan:l.wo_end_greater},"e_w[insurrance_h_expire]":{greaterEqualThan:l.ew_ih_greater}},c={"employee[name]":{required:!0,maxlength:45},"employee[japanese_name]":{maxlength:45},"employee[email]":{required:!0,email:!0,maxlength:100},"employee[birthday]":{},"employee[id_card_number]":{maxlength:255},"employee[id_card_place]":{maxlength:255},"employee[passport_number]":{maxlength:50},"employee[passport_date_start]":{},"employee[passport_date_exprie]":{greaterEqualThan:'[name="employee[passport_date_start]"]'},"employee[passport_addr]":{maxlength:255}},p=0;p<100;p++){var u="team["+p+"][start_at]";c[u]={required:!0}}s.attach={domW:e('[data-doc-scan="files"]'),uploader:null,imageInfo:[],init:function(){if("undefined"==typeof qq)return!0;var t=this;t.domUpload=e("#profile-attach-files"),t.uploader=new qq.FineUploader({element:t.domUpload[0],request:{endpoint:o.urlUploadAttachFile,params:{_token:i.token}},deleteFile:{enabled:!0,endpoint:o.urlDeleteAttachFile,confirmMessage:"Are you sure you want to delete {filename}?",forceConfirm:!0,params:{_token:i.token}},validation:{allowedExtensions:["jpeg","jpg","gif","png","pdf","doc","docx","xls","xlsx"],sizeLimit:5e6},callbacks:{onComplete:function(e,a,n){n.item2_id&&t.uploader.setUuid(e,n.item2_id),n.item2_path&&(t.imageInfo[e]=o.urlAssetStorage+n.item2_path),n.file_upload&&t.insertResponseInputFile(n.file_upload)}},thumbnails:{placeholders:{notAvailablePath:o.urlFileNotAvai}}}),t.initFiles(),e(a).on("click",'.qq-thumbnail-selector[qq-server-scale], [data-qq-selector="download"]',function(){var e=t.uploader.getId(this);if("string"!=typeof t.imageInfo[e])return!0;var a=n.open(t.imageInfo[e],"_blank");a.focus()})},insertResponseInputFile:function(e){var t,a=this,n=a.domUpload.next('input[name="file_json"]');n.length?t=n.val()+",":(a.domUpload.after('<input type="hidden" name="file_json" value="" />'),n=a.domUpload.next('input[name="file_json"]'),t=""),n.val(t+JSON.stringify(e))},activeUpload:function(e){var a=this;a.domW.hasClass("hidden")&&("object"==typeof e&&e.relative_id&&(o.urlUploadAttachFile=t.stringToUrlReplace(o.urlUploadAttachFile,"0",""+e.relative_id),o.urlDeleteAttachFile=t.stringToUrlReplace(o.urlDeleteAttachFile,"0",""+e.relative_id)),a.domW.removeClass("hidden"),a.init())},initFiles:function(){if("object"!=typeof attachFiles)return!0;var t=this;e.each(attachFiles,function(e,a){t.uploader.addInitialFiles([{name:a.file_name,uuid:a.file_id,size:1e3*a.file_size,thumbnailUrl:o.urlAssetStorage+a.path}]),t.imageInfo[e]=o.urlAssetStorage+a.path})}},d.validate(),e(a).on("click","button[type=submit].btn-save-profile",function(){e(".group-team-position").each(function(){e(this).find("select").removeAttr("disabled")})});var h=[],f=[];e("#certificate-image").change(function(){for(var t=e(this),a=t[0].files,n=0;n<a.length;n++)h.push(a[n])}),e("#image_preview button.action-delete").click(function(){var t=e(this),a=t.parent().parent().attr("data-id"),n=t.parent().parent().attr("data-name");f.push({id:a,name:n})}),t.formEmployeeInfoSuccess=function(i,r){if(1==i.cer){var l=new FormData;l.append("_token",r.find('input[name="_token"]').val()),l.append("file_id",JSON.stringify(f));var d=0;e("#image_preview .imgPreviewWrap").each(function(t){if("undefined"!=typeof e(this).attr("data-index")){var a=e(this).attr("data-index"),n=h[a];n&&("object"==typeof n?(d+=n.size,l.append("images["+t+"]",n)):l.append("image_ids["+t+"]",n))}}),e.ajax({type:"POST",url:i.url,data:l,contentType:!1,processData:!1,success:function(){h=[],n.location.reload()},error:function(){n.location.reload()},complete:function(){n.location.reload()}})}if(i.arrNew)for(var m=0;m<i.arrNew.length;m++)e(".team-edit").find('[name="team['+i.arrNew[m].number+'][id]"]').val(i.arrNew[m].id),e(".team-edit").find('[name="team['+i.arrNew[m].number+'][id]"]').after('<input type="hidden" class="input-team-hidden" name="team['+i.arrNew[m].number+'][team]" value="'+i.arrNew[m].team+'"/>');if(e(".team-edit .team").prop("disabled",!0),o.isSelfProfile&&e("img#employee-avatar_url").length&&e('[data-dom-flag="profile-avatar"]').html('<img src="'+e("img#employee-avatar_url").attr("src")+'" class="user-image" />'),i.employee_id){e('[data-flag-profile="base-email"]').remove(),r.attr("action",t.stringToUrlReplace(r.attr("action"),"0",""+i.employee_id)),t.urlReplace(t.stringToUrlReplace(o.urlViewProfile,"0",""+i.employee_id)),e('[data-flag-dom="employee-left-menu"] > li.disabled').each(function(a,n){e(n).removeClass("disabled");var r=e(n).children("a");r.attr("href",t.stringToUrlReplace(r.attr("href"),"0",""+i.employee_id))});var c=e('[data-flag-dom="btn-employee-remove"]');c.length&&(c.removeClass("hidden"),c.attr("action",t.stringToUrlReplace(c.attr("action"),"0",""+i.employee_id)))}if(i.urlFormSubmitChange&&r.attr("action",i.urlFormSubmitChange),i.urlFormDeleteItem){var c=e('[data-flag-dom="btn-employee-remove-item"]');c.removeClass("hidden"),c.attr("action",i.urlFormDeleteItem)}"attach"===o.tabType&&s.attach.activeUpload(i),"undefined"!=typeof isCer&&isCer===!0&&a.location.reload()},e('[data-flag-dom="employee-left-menu"] > li').click(function(){if(e(this).hasClass("disabled"))return!1}),selectSearchReload(),e(".input-select-team-member").change(function(t){var a=e(".tab-content .tab-content .active").attr("id"),i=e(this).val();a?n.location.href=i+"#"+a:n.location.href=i}),e("[data-checkbox-source]").length&&e("[data-checkbox-source]").change(function(){var t=e(this),a=t.data("checkbox-source"),n=t.is(":checked");return!a||void e('[data-checkbox-dist="'+a+'"]').prop("disabled",!n)});var g={init:function(){var t=this;return t.checkbox=e('[data-flag-dom="rela-birth-checkbox"]'),!t.checkbox.length||(t.action(),void t.checkbox.change(function(){t.action()}))},action:function(){var t=this;t.checkbox.is(":checked")?(e('[data-flag-dom="rela-birth-day"]').addClass("hidden"),e('[data-flag-dom="rela-birth-year"]').removeClass("hidden")):(e('[data-flag-dom="rela-birth-day"]').removeClass("hidden"),e('[data-flag-dom="rela-birth-year"]').addClass("hidden"))},baseMatchHeight:function(){e('[data-height-same="team"]').matchHeight({child:".box",notHeight:!0})}};switch(o.tabType){case"skill":t.autoComplete.init({beforeRemote:function(){var t=e('[name="skill[type]"]').val();return!(!t||t===o.skillTypeAnother)&&{params:{type:e('[name="skill[type]"]').val()}}}});break;case"education":t.autoComplete.init({afterSelected:function(t){t.country&&e('[name="edu[country]"]').val(t.country).change(),t.province&&e('[name="edu[province]"]').val(t.province).change()}});break;case"certificate":s.cer={init:function(){var t=this;t.changeType(e("#select-cer option:selected").attr("type")),e('[name="cer[certificate_id]"]').change(function(){var a=e("option:selected",this).attr("type");t.changeType(a),e("#select-type").val(a).change()})},changeType:function(t){1!=t&&(t=2),1!=t&&e('[data-cer-level="1"] input').val(""),e("[data-cer-level]").addClass("hidden"),e('[data-cer-level="'+t+'"]').removeClass("hidden")}},s.cer.init(),t.autoComplete.init();break;case"experience":e('[name="exp[start_at]"], [name="exp[end_at]"]').on("dp.change",function(){var t=e('[name="exp[start_at]"]').data("DateTimePicker").date(),a=e('[name="exp[end_at]"]').data("DateTimePicker").date();if(!t||!a||a.isBefore(t))return!0;var n=a.diff(t,"years"),i=a.diff(t,"months");i-=12*n,i=i>0?i:0,e('[name="ex_mo[per_y]"]').val(n),e('[name="ex_mo[per_m]"]').val(i)});break;case"base":g.baseMatchHeight()}var _=function(t){var a=t.data("id");t.is(":checked")?e(".team-group-function[data-id="+a+"]").show():e(".team-group-function[data-id="+a+"]").hide()};e("input.input-is-function").each(function(t,a){_(e(this))}),e("input.input-is-function").on("change",function(t){_(e(this))}),s.teamPosi={change:function(){var t=e('[data-flag-dom="btn-add-profile-team"]:not([data-btn-add="profile-last"])'),a=e('[data-flag-dom="btn-add-profile-team"][data-btn-add="profile-last"]');t.length?(a.addClass("hidden"),t.addClass("hidden"),t.last().removeClass("hidden")):a.removeClass("hidden")},left:function(){var t=this;return t.domLeft=e('[data-flag-dom="label-left"]'),t.inputLeft=e('[name="employee[leave_date]"]'),t.domLeft.length&&t.inputLeft.length?(this.leftExec(),void this.leftChange()):(t.domLeft.addClass("hidden"),!0)},leftExec:function(){var e=this;if(!e.inputLeft.val().trim())return e.domLeft.addClass("hidden"),!0;var t=e.domLeft.data("text-left"),a=e.domLeft.data("text-will"),n=e.inputLeft.data("DateTimePicker").date().startOf("day"),i=(new moment).startOf("day");i.isAfter(n)?e.domLeft.html(t):e.domLeft.html(a),e.domLeft.removeClass("hidden")},leftChange:function(){var e=this;e.inputLeft.on("dp.change",function(){e.leftExec()})}};var v=e(".group-team-position-orgin").html();e(".group-team-position-orgin").remove();var b=e(".box-form-team-position").children(".group-team-position").length;b=b?parseInt(b):0,1==b&&e(".box-form-team-position .group-team-position .input-remove").addClass("warning-action"),s.teamPosi.change(),e(a).on("click touchstart",'[data-flag-dom="btn-add-profile-team"]',function(t){b++;var a=e(v),n="team["+b+"]";a.find(".input-team-position.input-team .input-id-hidden").attr("name",n+"[id]"),a.find(".input-team-position.input-team select").attr("name",n+"[team]"),a.find(".input-team-position.input-team select").attr("id",b),a.find(".input-team-position.input-team .input-team-hidden").attr("name",n+"[team]"),a.find(".input-team-position.input-position select").attr("name",n+"[position]"),a.find(".input-team-position.input-start_date .date-picker").attr("name",n+"[start_at]"),a.find(".input-team-position.input-end_date .date-picker").attr("name",n+"[end_at]"),a.find(".input-team-position.is_working .is-working").attr("name",n+"[is_working]"),a.find('select[data-flag-dom="select2"]').addClass("select-search"),e(".box-form-team-position").append(a),e(".box-form-team-position .group-team-position .input-remove").removeClass("warning-action"),1==e(".box-form-team-position").children(".group-team-position").length?e(".box-form-team-position .group-team-position .input-remove").addClass("warning-action"):e(".box-form-team-position .group-team-position .input-remove").addClass("warn-confirm"),e('input[name="employee_team_change"]').val(1),selectSearchReload(),s.teamPosi.change(),g.baseMatchHeight(),e('input[data-flag-type="date"]').datetimepicker({format:"YYYY-MM-DD",useCurrent:!1})}),e(a).on("click touchstart",'[data-flag-dom="btn-remove-profile-team"]',function(t){e('input[name="employee_team_change"]').val(1),s.teamPosi.change(),g.baseMatchHeight()}),e(a).on("change",".group-team-position select",function(t){e('input[name="employee_team_change"]').val(1)}),e("#employee-role-form").on("hide.bs.modal",function(t){var a="";e(this).find(".checkbox input:checked").each(function(t,n){a+="<li><span>",a+=e(this).parent().text().trim(),a+="</li></span>"}),e("ul.employee-roles").html(a),g.baseMatchHeight()}),e('[name="role[]"]').change(function(){e("input[name=employee_role_change]").val(1)}),lengthTrTableRule=e(".team-rule-wrapper table.table-team-rule tbody tr").length,e(".team-rule-wrapper table.table-team-rule tbody tr:last-child .form-input-dropdown").addClass("input-rule-last"),e(".team-rule-wrapper table.table-team-rule tbody tr:nth-child("+(lengthTrTableRule-1)+") .form-input-dropdown").addClass("input-rule-last");var y=e(".team-rule-wrapper .table-responsive").css("padding-bottom");if(e(".input-rule-last").on("show.bs.dropdown",function(){e(".team-rule-wrapper .table-responsive").css("padding-bottom","90px")}),e(".input-rule-last").on("hide.bs.dropdown",function(){e(".team-rule-wrapper .table-responsive").css("padding-bottom",y)}),e(a).on("change","#program-id",function(){var t=e(this).find("option:selected").text(),a=e(this).parent().find(".program-name");a.val(t)}),g.init(),t.uploadFile.init(),t.select2.init({minimumInputLength:1}),s.teamPosi.left(),s.attach.init(),e("#modal_contract_history").on("shown.bs.modal",function(t){var a=e("#modal_contract_history");a.find(".modal-body").html(""),e.ajax({url:a.data("url"),type:"GET",data:{employeeId:a.data("employee-id")},success:function(e){a.find(".modal-body").html(e)}})}),e("#business_trip_tbl").length>0){var x=e("#business_trip_tbl"),C=x.find("tbody tr.none-row"),w=parseInt(e('.grid-pager-box select[name="limit"] option:selected').attr("data-value"));e("#btn_add_business").click(function(t){t.preventDefault();var a=x.find("tbody tr:last()");if(!a.hasClass("new-item")||a.hasClass("hidden")){var n=e("#tr_business_tpl").clone().removeAttr("id").removeClass("hidden");C.addClass("hidden"),n.appendTo(x.find("tbody")),r()}}),e("body").on("click",".btn-busi-delete",function(t){t.preventDefault();var a=e(this),r=a.closest("tr");if(r.hasClass("new-item"))return r.remove(),!1;var o=a.attr("data-url");return!(a.is(":disabled")||!o)&&void bootbox.confirm({message:a.attr("data-noti"),className:"modal-warning",callback:function(t){t&&(a.prop("disabled",!0),r.addClass("bg-yellow"),e.ajax({url:o,type:"POST",data:{id:r.find('[name="id"]').val(),_token:i.token},success:function(t){if(t.status){var a=0,i=x.find("tbody tr:last() td.col-stt");i.length>0&&(a=parseInt(i.text()));var o=parseInt(e(".grid-pager-box .total").text());a===o?(r.remove(),x.find("tbody tr:not(:first)").not(".hidden").not(".new-item").not(".edit-item").each(function(t){e(this).find(".col-stt").text(t+1)}),decPaginateTotal()):n.location.reload()}else bootbox.alert({message:t.message,className:"modal-danger"})},complete:function(){a.prop("disabled",!1),r.removeClass("bg-yellow")}}))}})}),e("body").on("click",".btn-busi-edit",function(t){t.preventDefault();var a=e(this),n=a.closest("tr");if(!(n.next(".edit-item").length>0)){var i=n.find('input[name="id"]').val(),o=e("#tr_business_tpl").clone().removeAttr("id").removeClass("hidden").removeClass("new-item").addClass("edit-item");o.find(".field").each(function(){var t=e(this).attr("name"),a=n.find("td.col-"+t);a.length>0&&e(this).val(a.text())}),o.find("td.col-actions").prepend('<input type="hidden" name="id" value="'+i+'" class="field">'),o.find("td.col-actions .btn-busi-delete").addClass("hidden"),o.find("td.col-actions .btn-busi-cancel").removeClass("hidden"),o.insertAfter(n),r()}}),e("body").on("click",".btn-busi-cancel",function(t){t.preventDefault(),e(this).closest("tr").remove()}),e("body").on("click",".btn-busi-save",function(t){t.preventDefault();var a=e(this),r=a.closest("tr"),o=r.find(".field"),l=a.attr("data-url"),s=a.find("i");if(!(o.length<1||!l||s.hasClass(".fa-spin"))){var d={_token:i.token},m=!1;o.each(function(){var t=e(this).val().trim();e(this).hasClass("required")&&(t?e(this).next(".error").remove():(e(this).next(".error").length<1&&e(this).after('<label class="error">'+textErrorRequired+"</label>"),m=!0)),d[e(this).attr("name")]=t});var c=r.find('[name="start_at"]'),p=r.find('[name="end_at"]');if(p.val()&&c.val()&&(p.val()<c.val()?(p.next(".error").length<1&&p.after('<label class="error">'+textErrorEndDate+"</label>"),m=!0):p.next(".error").remove()),m)return!1;s.removeClass("fa-save").addClass("fa-refresh fa-spin"),a.prop("disabled",!0),e.ajax({type:"POST",url:l,data:d,success:function(t){if(!t.status)return void bootbox.alert({message:t.message,className:"modal-danger"});var a=r.prev("tr"),i=0,o=r.hasClass("edit-item");if(a.length>0){var l=a.find(".col-stt").text();i=l?parseInt(l):0}if(i>=w&&!o)return void n.location.reload();o||i++;var s=t.item;s.stt=i;var d=r.clone().removeClass("edit-item new-item");e.each(s,function(e,t){d.find(".col-"+e).text(t)}),d.find('td.col-actions [name="id"]').length<1&&d.find("td.col-actions").prepend('<input type="hidden" name="id" value="'+s.id+'" class="field">'),d.find(".col-actions .btn-busi-delete").removeClass("new-del hidden"),d.find(".col-actions .btn-busi-save").addClass("hidden"),d.find(".col-actions .btn-busi-cancel").addClass("hidden"),d.find(".col-actions .btn-busi-save i.fa").addClass("fa-save").removeClass("fa-refresh fa-spin"),d.find(".col-actions .btn-busi-edit").removeClass("hidden"),o?(a.replaceWith(d),r.remove()):(r.replaceWith(d),incPaginateTotal())},complete:function(){a.prop("disabled",!1),s.addClass("fa-save").removeClass("fa-refresh fa-spin")}})}})}}(jQuery,RKExternal,document,window,siteConfigGlobal),$(document).on("change","#program-id",function(){var e=$(this).find("option:selected").text(),t=$(this).parent().find(".program-name");t.val(e)}),$(document).on("click",".btn-edit-profile",function(){$("#form-employee-info input, #form-employee-info select, #form-employee-info textarea").not(".fill-disable").prop("disabled",!1),$("#form-employee-info .btn-del-empl").removeClass("hidden"),$("#form-employee-info .imgPreviewWrap button").prop("disabled",!1),$(".team-edit .team").prop("disabled",!0);var e=$(".box-form-team-position").children(".group-team-position").length;1===e&&($(".box-form-team-position .group-team-position .input-remove").addClass("warning-action"),$(".box-form-team-position .group-team-position .input-remove").removeClass("warn-confirm")),$("#form-employee-info button[type=submit]").show(),$("#form-employee-info button[id=request-approve]").show(),$(this).addClass("hidden"),$("[data-checkbox-source]").change();var t=$('[data-flag-dom="btn-add-profile-team"]:not([data-btn-add="profile-last"])'),a=$('[data-flag-dom="btn-add-profile-team"][data-btn-add="profile-last"]'),n=$('[data-flag-dom="btn-remove-profile-team"]');n.removeClass("hidden"),t.length?(a.addClass("hidden"),t.addClass("hidden"),t.last().removeClass("hidden")):a.removeClass("hidden"),selectSearchReload()}),$(document).on("change",'.input-team-position select[data-flag-dom="select2"]',function(){checkDisplayResponsibleTeam()}),$(document).on("change",".group-team-position .team",function(){var e=$(this).closest(".group-team-position").find(".input-start-at"),t=$(this).closest(".group-team-position").find(".input-end-at");$(this).focusout(),e.val(""),t.val(""),setTimeout(function(){e.focus()},300);var a=$(this),n=$(this).closest(".group-team-position").find(".input-end-at");$(".group-team-position .team").each(function(){var e=$(this).closest(".group-team-position").find(".input-end-at"),t=$(this).closest(".group-team-position").find(".input-start-at");if(e.parent().find("label.error").remove(),t.parent().find("label.error").remove(),a.val()===$(this).val()&&a.attr("id")!==$(this).attr("id")&&""===n.val()&&""===e.val())return n.after('<label class="error">'+noEndDate+"</label>"),e.after('<label class="error">'+noEndDate+"</label>"),!1})}),$(document).on("click","button[type=submit].btn-save-profile",function(){var e=!0;hasChecked=!1;var t=new Date,a=$(".group-team-position").length;now=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0");var n=[];return $(".group-team-position").each(function(){var t=$(this).find(".input-end-at").val(),i=$(this).find(".input-start-at").val(),r=$(this).find(".select2-hidden-accessible").val();if(1===a&&$(this).find(".is-working").prop("checked",!0),jQuery.inArray(r,listTeamJP)>=0&&n.push(r),$(this).find(".is-working").is(":checked")&&(""!==t&&t>=now||""===t)&&($(".is-working-error").addClass("hidden"),hasChecked=!0),""!==t&&t<=i)return RKExternal.notify(timeEndAfterStart,!1),e=!1,!1}),n.length>0?checkJP=1:checkJP=0,isJP!==checkJP?($("#notice-change-team").modal("show"),!1):!!e&&(hasChecked?void 0:($(".is-working-error").removeClass("hidden"),!1))}),$("#confirm-change-team").click(function(){if(isJP=checkJP,$("#notice-change-team").modal("hide"),!hasChecked)return $(".is-working-error").removeClass("hidden"),!1});var isSubmitUploadAvatar=!1,originalData=getDataProfileBase($("#form-employee-info").serializeArray()),currentData=originalData;"object"==typeof typeAllow&&$(".input-box-img-preview").previewImage({type:typeAllow,size:sizeAllow,default_image:imagePreviewImageDefault,message_size:txtMessageSize,message_type:txtMessageType}),$("#employee-avatar_url").on("click",function(e){e.preventDefault();var t=$("#avatar_url");t.length&&t.trigger("click")}),$("#avatar_url").change(function(){isSubmitUploadAvatar=!0,$("#form-employee-info").submit()}),RKExternal.callbackGetFormData=function(e){var t=new FormData;if(isSubmitUploadAvatar===!0){isSubmitUploadAvatar=!1;var a=e.find('input[name="avatar_url"]')[0].files[0];return!(!a||typeAllow.indexOf(a.type)===-1||a.size/1e3>sizeAllow)&&(t.append("avatar_url",a),t.append("_token",siteConfigGlobal.token),t)}var n=e.serializeArray();currentData=getDataProfileBase(n);var i=!compareObjects(originalData.basic,currentData.basic),r=!compareObjects(originalData.teams,currentData.teams)||!compareObjects(originalData.team_responsible,currentData.team_responsible),o=JSON.stringify(originalData.roles)!==JSON.stringify(currentData.roles);return i||r||o?(n.map(function(e){t.append(e.name,e.value)}),t.append("is_change_basic",i?"1":"0"),t.append("is_change_team",r?"1":"0"),t.append("is_change_role",o?"1":"0"),
t):($(".team-edit .team").prop("disabled",!0),RKExternal.notify(globalPassModule.trans.save_successfully,!0,{delay:1e4}),!1)},RKExternal.updateOriginalData=function(e){"object"==typeof e.responseJSON&&(e=e.responseJSON),e.status+""=="1"&&(originalData=currentData)},$("body").on("click",".q_view_more",function(e){e.preventDefault();var t=$(this).closest(".q_content_toggle"),a=$(this).data("fullText"),n=$(this).data("shortText");t.hasClass("q_show")?(t.removeClass("q_show"),$(this).text("["+a+"]")):(t.addClass("q_show"),$(this).text("["+n+"]"))});