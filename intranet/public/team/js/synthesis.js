!function(e,t,a,i){var n="object"==typeof globalPassModule?globalPassModule:{},d="object"==typeof globalTrans?globalTrans:{},l="object"==typeof varProjTag?varProjTag:{},s="object"==typeof globalDbTrans?globalDbTrans:{},r={};r.lang={cookieKey:"cv_lang",init:function(){var t=this,a=e.cookie(t.cookieKey);"en"!==a&&(a="ja"),e('[name="cv_view_lang"][value="'+a+'"]').prop("checked",!0),t.exec(),e('[name="cv_view_lang"]').change(function(){t.exec()})},getLangCur:function(){var t=e('[name="cv_view_lang"]:checked').val();return"en"!==t&&(t="ja"),t},exec:function(){var t=this,a=t.getLangCur();e.cookie(t.cookieKey,a,{expires:7}),e('[data-lang-show]:not([data-lang-show="'+a+'"])').addClass("hidden"),e('[data-lang-show="'+a+'"]').removeClass("hidden"),e("[data-lang-r]").each(function(t,i){var n=e(i).data("lang-r");"undefined"!=typeof d[a][n]?e(i).html(d[a][n]):e(i).html("")}),e("[data-db-lang]").each(function(t,i){var n=e(i).data("db-lang");"undefined"!=typeof s[n+"_"+a]?e(i).html(s[n+"_"+a]):e(i).html("")})}},r.lang.init(),r.edit={fgDom:'[data-dom-edit="dbclick"]',fgInput:"[data-edit-input]",fgLabel:"[data-edit-label]",fgInputName:'[data-edit-name="col"]',fgInputValue:'[data-edit-value="value"]',fgIn:'[data-edit-field="input"]',fgDataIn:"[data-edit-field]",isAjaxProgres:!1,clickOne:!1,select2Selected:!1,messagesValid:{},resultValidate:!0,htmlRow:{checkTr:'<i class="fa fa-circle"></i>'},init:function(){var d=this;if(d.submitType(),e(d.fgDom).each(function(t,a){d.editDom(e(a))}),!n.isAccess)return!0;d.validatorThis(),e(a).on("dblclick",d.fgDom,function(t){t.preventDefault(),d.editDom(e(this),!0)}),e(a).mouseup(function(t){setTimeout(function(){if(d.clickOne)return d.clickOne=!1,clearTimeout(d.timer),!0;if(d.timer=setTimeout(function(){d.clickOne=!1},200),d.clickOne=!0,d.select2Selected)return d.select2Selected=!1,!0;if(!e(d.fgDom).is(t.target)&&0===e(d.fgDom).has(t.target).length)return d.viewMode(),!0;var a;return a="dbclick"===e(t.target).data("dom-edit")?e(t.target):e(t.target).closest(d.fgDom),!(!a||!a.length)&&(a.children(d.fgLabel).hasClass("hidden")?void 0:(d.viewMode(),!0))})}),e(a).keyup(function(e){27===e.keyCode&&d.viewMode()}),e(a).on("change",d.fgDataIn,function(){d.inputChange(e(this))}),e("[data-row-edit]").each(function(t,a){var i=e(a).data("row-edit");d.htmlRow[i]=e(a).children("table").children("tbody").html(),e(a).remove()});var l=1;e("[data-btn-row-add]").click(function(a){a.preventDefault();var i=e(this),n=i.data("btn-row-add");if("undefined"==typeof d.htmlRow[n])return!0;var s=e(d.htmlRow[n].replace(/(\-9999)/g,"new"+l));l++,e('[data-row-add="'+n+'"]').before(s),t.select2.init({afterSelected:function(){d.select2Selected=!0}}),e('input[data-flag-type="date"]').datetimepicker({format:"YYYY-MM-DD",useCurrent:!1}).on("dp.change",function(t){d.inputChange(e(t.currentTarget))})}),e('input[data-flag-type="date"]').datetimepicker({format:"YYYY-MM-DD",useCurrent:!1}).on("dp.change",function(t){d.inputChange(e(t.currentTarget))}),t.select2.init({afterSelected:function(){d.select2Selected=!0}}),e("body").on("mousedown","[data-id][data-type]",function(t){if(3===t.which)return i.oncontextmenu=function(){return!1},d.deleteRowItem(e(this)),!1})},editDom:function(t,a){var i=this,d=t.closest("tr[data-id]");if(t.children(i.fgLabel).hasClass("hidden"))return!0;var s=t.children(i.fgLabel),r=s.data("edit-label"),c=t.data("edit-name"),o=t.data("edit-value");"undefined"==typeof o&&(o=s.text().trim());var u=t.children(i.fgInput),p=u.find(i.fgIn);if(!u.length&&n.isAccess){switch(r){case"date":u='<span data-edit-input="text" class="cv-input"><input disabled data-input-disabled="1" class="form-control input-click-edit" name="'+c+'" value="'+o+'" type="text" data-edit-field="input" data-flag-type="date" /></span>',u=i.insertInput(t,u);break;case"textarea":u='<span data-edit-input="text" class="cv-input"><textarea disabled data-input-disabled="1" class="form-control input-click-edit" name="'+c+'" data-edit-field="input">'+o+"</textarea></span>",u=i.insertInput(t,u);break;case"os":case"lang":case"language":case"database":var f="";f=s.data("edit-multi")&&"no"===s.data("edit-multi")?"":" multiple",u='<span data-edit-input="selectMulti" class="cv-input"><select disabled data-input-disabled="1" name="'+c+'"'+f+' data-select2-dom="1" data-edit-field="input" data-select2-url="'+n["urlRemote"+r]+'"></select></span>',u=i.insertInput(t,u);break;case"check-tr":u='<span data-edit-input="check-tr" class="cv-input"><input type="checkbox" disabled data-input-disabled="1" name="'+c+'" data-edit-field="input" value="'+o+'" /></span>',u=i.insertInput(t,u);break;case"select-lang":var g=t.data("edit-values"),h=t.data("edit-value");u='<span data-edit-input="select-lang" class="cv-input"><select disabled data-input-disabled="1" name="'+c+'" data-edit-field="input" data-edit-values="'+g+'" data-edit-value="'+h+'"></select></span>',u=i.insertInput(t,u);break;default:u='<span data-edit-input="text" class="cv-input"><input disabled data-input-disabled="1" class="form-control input-click-edit" name="'+c+'" value="'+o+'" type="text" data-edit-field="input" /></span>',u=i.insertInput(t,u)}if(p=u.find(i.fgIn),"selectMulti"===u.data("edit-input")){p.val("");var v="",m=d.data("id");s.data("id")?v='<option selected value="'+s.data("id")+'">'+o+"</option>":"undefined"==typeof l[m]||"undefined"==typeof l[m][r]?v="":e.each(l[m][r],function(e,t){v+='<option selected value="'+e+'">'+t+"</option>"}),p.html(v),p.change()}}switch("select-lang"===u.data("edit-input")&&i.selectLanguage(p),a?(p.prop("disabled",!1),s.addClass("hidden"),u.removeClass("hidden")):(s.removeClass("hidden"),u.addClass("hidden")),u.data("edit-input")){case"text":p.val("").focus().val(o);break;case"check-tr":s.html().trim()?p.prop("checked",!0):p.prop("checked",!1)}},viewMode:function(){var t=this;t.resultValidate=!0,e(t.fgDom+" "+t.fgLabel+".hidden").each(function(a,i){var n,c,o=e(i),u=o.siblings(t.fgInput),p=u.closest("tr[data-id][data-type]"),f=u.data("edit-input"),g=u.find(t.fgIn),h=p.data(h),v=g.val();if(n=o.data("dom-error")&&e(o.data("dom-error")).length?e(o.data("dom-error")):g,c=n.closest(t.fgDom).find(t.fgLabel).data("valid-type"),!t.validate(n,c))return t.resultValidate=!1,!0;switch(f){case"selectMulti":var m="",b={};v&&e(g).find("option").each(function(t,a){v.indexOf(e(a).attr("value"))>-1&&(m+=e(a).text()+", ",b[e(a).attr("value")]=e(a).text())}),m=m.slice(0,-2),o.text(m),"undefined"==typeof l[h]&&(l[h]={}),l[h][o.data("edit-label")]=b;break;case"check-tr":g.is(":checked")?(p.find('[data-edit-label="check-tr"]').html(""),p.find('[data-edit-input="check-tr"]').find(t.fgDataIn).prop("checked",!1),o.html(t.htmlRow.checkTr),g.prop("checked",!0)):o.html("");break;case"select-lang":var m="",y=r.lang.getLangCur();v&&(m+=e(i).text()+", "),o.text(d[y][v]),g.data("edit-value",v),o.data("lang-r",v);break;default:o.text(v)}if(o.data("db-lang")){var k=o.data("db-lang");s[k+"_"+r.lang.getLangCur()]=v}"1"===g.data("input-disabled")&&g.prop("disabled",!0),u.addClass("hidden"),o.removeClass("hidden")}),t.resultValidate&&e('[type="submit"][data-btn-submit]').prop("disabled",!1)},insertInput:function(t,a){return a=e(a),t.append(a),a},saveInput:function(){var a=this,i=e(a.fgDom+" "+a.fgInput+":not(.hidden):first");if(!i.length)return!0;var d=i.closest("tr[data-id][data-type]");if(!d.length)return!0;var s=d.data("id"),r=d.data("type");if(!s||!r)return!0;var c,o=i.find(a.fgIn),u=i.data("edit-input");c="selectMulti"===u&&null===o.val()?encodeURI(o.attr("name"))+"=NULL":o.serialize(),a.isAjaxProgres=!0,e.ajax({url:n.urlSaveCv,type:"POST",dataType:"json",data:c+"&id="+s+"&typeSave="+r+"&_token="+siteConfigGlobal.token,success:function(n){if("undefined"==typeof n.status||!n.status)return t.notify(n.message,!1),!0;var r=i.siblings(a.fgLabel);if("selectMulti"===u){var c=o.val(),p="",f={};c&&e(o).find("option").each(function(t,a){c.indexOf(e(a).attr("value"))>-1&&(p+=e(a).text()+", ",f[e(a).attr("value")]=e(a).text())}),p=p.slice(0,-2),r.text(p),l[s][r.data("edit-label")]=f}else r.text(o.val());n.id&&d.data("id",n.id)},error:function(){t.notify("System error",!1)},complete:function(){a.viewMode(),a.isAjaxProgres=!1,e("[is-ajax]").attr("is-ajax",0)}})},selectLanguage:function(t){if(!t.data("edit-values"))return!0;var a,i=r.lang.getLangCur(),n=t.data("edit-values").split("|"),l=t.data("edit-value"),s="";e.each(n,function(e,t){a=t===l?" selected":"",s+='<option value="'+t+'"'+a+">"+d[i][t]+"</option>"}),t.html(s)},deleteRowItem:function(t){var a=t.data("id"),i=t.data("type");a&&i&&!isNaN(a)&&parseInt(a)>0&&t.before('<input type="hidden" name="remove['+i+'][]" value="'+a+'" />'),e('[data-id="'+a+'"][data-type="'+i+'"]').remove()},submitType:function(){e("[data-btn-submit]").click(function(){var t=e(this),a=t.data("btn-submit"),i=t.siblings('input[name="save_type"]');i.length||(t.after('<input type="hidden" name="save_type" value="" />'),i=t.siblings('input[name="save_type"]')),i.val(a)})},validate:function(t,a){var i=this;if(void 0===typeof a||!a)return i.inputValidPass(t),!0;try{"string"==typeof a&&(a=JSON.parse(a))}catch(n){return i.inputValidPass(t),!0}t.data("valid-pass",!0);var d=t.next(".error");return d.length||(t.after('<label class="error hidden"></label>'),d=t.next(".error")),e.each(a,function(a,n){if(!t.data("valid-pass"))return i.resultValidate=!1,i.inputValidFail(t),!0;if("function"!=typeof e.validator.methods[a])return i.inputValidPass(t),!0;if(e.validator.methods[a](t.val(),t[0],n))return i.inputValidPass(t),!0;if(i.resultValidate=!1,i.inputValidFail(t),"undefined"==typeof i.messagesValid[r.lang.getLangCur()]||"undefined"==typeof i.messagesValid[r.lang.getLangCur()][a])return!0;var l=i.messagesValid[r.lang.getLangCur()][a];"function"==typeof l&&(l=l.call(this,n)),d.html(l).removeClass("hidden")}),t.data("valid-pass")===!1?(i.showInputHideLabel(t),e('[type="submit"][data-btn-submit]').prop("disabled",!0),!1):(d.html("").addClass("hidden"),i.inputValidPass(t),!0)},validatorThis:function(){var t=this;t.messagesValid.en=e.extend({},e.validator.messages),t.messagesValid.en.greaterEqualThan=d.en["less start date"],t.messagesValid.en.isChecked=d.en["rank checked"],e.getScript("https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.15.0/localization/messages_ja.min.js",function(a,i,n){t.messagesValid.ja=e.validator.messages,t.messagesValid.ja.greaterEqualThan=d.ja["less start date"],t.messagesValid.ja.isChecked=d.ja["rank checked"]}),e.validator.methods.optional=function(){return!1},e.validator.methods.getLength=function(e){return e.length},e.validator.methods.depend=function(){return!0},e.validator.methods.checkable=function(t){e.validator.prototype.checkable(t)},e.validator.addMethod("isChecked",function(t,a,i){return!!e(a).closest("tr[data-id][data-type]").find('input[type="checkbox"]').filter(":checked").length},"Must checked.")},inputValidFail:function(e){e.data("valid-pass",!1),e.addClass("error")},inputValidPass:function(e){e.data("valid-pass",!0),e.removeClass("error")},inputChange:function(t){var a=this,i=t.closest("tr");i.data("id")&&i.data("type")?e('tr[data-id="'+i.data("id")+'"][data-type="'+i.data("type")+'"]').find(a.fgDataIn).data("input-disabled","0").prop("disabled",!1):t.data("input-disabled","0")},showInputHideLabel:function(e){var t=this,a=e.closest(t.fgDom);a.find(t.fgLabel).addClass("hidden"),a.find(t.fgInput).removeClass("hidden")}},r.edit.init()}(jQuery,RKExternal,document,window);