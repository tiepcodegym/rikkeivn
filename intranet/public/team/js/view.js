function get2Digis(e){return e<10?"0"+e:e}$(document).ready(function(){$("#form-employee-info input, #form-employee-info select, #form-employee-info textarea").not('#form-employee-info input[type="file"], #form-employee-info input[name="_token"], #form-employee-info textarea#comment').prop("disabled",!0),$("#form-employee-info input#certificate-image").prop("disabled",!0),$("#form-employee-info .imgPreviewWrap button").prop("disabled",!0),$("#form-employee-info button[type=submit]").not("#save_base").hide(),$('[data-flag-dom="btn-add-profile-team"]').addClass("hidden"),$('[data-flag-dom="btn-remove-profile-team"]').addClass("hidden"),selectSearchReload();var e=$("#employee-joindate"),t=$('input[name="employee[trial_date]"]'),a=$("#employee-trial_end_date"),n=$("#employee-offcial_date");e.on("dp.change",function(){$('select[name="e_w[contract_type]"]').val()===probationaryWorkingType&&t.val(e.val()).trigger("change")}),t.on("dp.change",function(){if($('select[name="e_w[contract_type]"]').val()===probationaryWorkingType){var t=$(this).val(),o=null;if(t&&""!==t){o=new Date(t);var i=new Date(t);i.setDate(1),i.setMonth(o.getMonth()+3),i.setDate(0),o.getDate()>28&&o.getDate()>i.getDate()?o=i:(o.setMonth(o.getMonth()+2),o.setDate(o.getDate()-1))}else n.is(":disabled")||n.val(e.val()).trigger("change");a.is(":disabled")||a.val(o?o.toDateString():null).trigger("change")}}),a.on("dp.change",function(){if($('select[name="e_w[contract_type]"]').val()===probationaryWorkingType){var e=$(this).val(),t=null;e&&(t=new Date(e),t.setDate(t.getDate()+1)),n.is(":disabled")||n.val(t?t.toDateString():null).trigger("change")}})}),Date.prototype.toDateString=function(){return this.getFullYear()+"-"+get2Digis(this.getMonth()+1)+"-"+get2Digis(this.getDate())},function(e){e("#setting_app_container").length>0&&(e(".btn-edit-form").click(function(t){t.preventDefault();var a=e(this).closest(".form-action-btns");a.find(".btn-save-form, .btn-cancel-form").removeClass("hidden"),e(this).addClass("hidden"),e(this).closest("form").find("input, .btn-toggle-pass").prop("disabled",!1)}),e(".btn-cancel-form").click(function(t){t.preventDefault();var a=e(this).closest(".form-action-btns");a.find(".btn-save-form").addClass("hidden"),a.find(".btn-edit-form").removeClass("hidden"),e(this).addClass("hidden"),e(this).closest("form").find("input, .btn-toggle-pass").prop("disabled",!0)}),e(".btn-toggle-pass").mousedown(function(){e(this).closest(".input-group").find("input").attr("type","text")}).mouseup(function(){e(this).closest(".input-group").find("input").attr("type","password")}),e.validator.addMethod("exceptSpace",function(e,t){return this.optional(t)||e.indexOf(" ")<0&&""!=e},"Password not allow space!"),e("#form_file_password").validate({ignore:"",rules:{"emp_setting[pass_open_file]":{required:!0,minlength:4,maxlength:20,exceptSpace:!0,remote:{url:urlcheckExistSetting,type:"POST",data:{_token:siteConfigGlobal.token,key:"pass_open_file",value:function(){return e('[name="emp_setting[pass_open_file]"]').val()}}}},new_password:{required:!0,minlength:4,maxlength:20,exceptSpace:!0},new_password_confirmation:{required:!0,minlength:4,maxlength:20,equalTo:'[name="new_password"]',exceptSpace:!0}},messages:{"emp_setting[pass_open_file]":{remote:"Wrong input password!"}}}),RKExternal.formEmployeeInfoSuccess=function(e,t){var a=t.find(".form-action-btns");a.find(".btn-cancel-form").trigger("click"),t.hasClass("reset-after-submit")&&t[0].reset()},e("#btn_show_password").click(function(t){t.preventDefault();var a=e(this);bootbox.prompt({title:textEnterPasswordToShow,inputType:"password",className:"modal-default",callback:function(t){t&&e.ajax({url:urlcheckExistSetting,type:"POST",data:{_token:siteConfigGlobal.token,key:"pass_open_file",value:t,history:1},success:function(t){if(t.trueKey){var n=e(a.attr("data-modal"));n.modal("show");var o=n.find(".modal-body .table tbody"),i="";e.each(t.histories,function(e,t){i+="<tr><td>"+t.value+(t.is_current?' <i class="color-green fa fa-check"></i>':"")+"</td><td>"+t.updated_at+"</td></tr>"}),o.html(i),setTimeout(function(){n.modal("hide"),n.find(".modal-body .table tbody").html("")},6e4)}else RKExternal.notify(textPasswordErrorTryAgain,"warning")},error:function(e){RKExternal.notify(e.responseJSON,"warning")}})}})}),e(".btn-check-pass").click(function(t){var a=e(".app-password").val();e(".loading-check-pass").removeClass("hidden"),e(this).attr("disabled","disabled"),t.preventDefault(),e.ajax({url:urlcheckAppPass,type:"GET",data:{_token:siteConfigGlobal.token,appPass:a},success:function(t){e(".loading-check-pass").addClass("hidden"),bootbox.alert({className:t===!0?"modal-success text-center":"modal-danger text-center",message:t===!0?checkAppPassSuccess:textPasswordErrorTryAgain}),t!==!0&&e(".btn-check-pass").prop("disabled",!1)},error:function(e){RKExternal.notify(e.responseJSON,"warning")}})})),e(".app-password").on("input",function(t){var a=e(".btn-check-pass"),n=e(this).prop("defaultValue");n!==e(this).val()?a.prop("disabled",!1):a.attr("disabled","disabled")})}(jQuery);