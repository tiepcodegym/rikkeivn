function initAudioPlayer(){$("video.test-audio").each(function(){if(!($(this).next(".audio-player").length>0)){var e=$("#audio_template").clone().removeAttr("id").removeClass("hidden");$(this).after(e);var r=e.find(".playing-bar .handle-time"),i=e.find(".playing-bar .full-time"),t=e.find(".playing-bar .curr-time"),a=e.find(".duration-bar .curr-dur"),n=this;$(n).on("error",function(r){e.after('<p class="error">Audio not found</p>'),e.addClass("audio-error")}),setTimeout(function(){e.hasClass("audio-error")||e.find(".duration-bar .full-dur").text(convertTime(n.duration))},300),r.draggable({axis:"x",containment:i,drag:function(){if(e.hasClass("audio-error"))return!1;var r=$(this).position().left,o=r/i.width();t.width(r),n.currentTime=o*n.duration,a.text(convertTime(n.currentTime))}})}})}function convertTime(e){if(!$.isNumeric(e))return"00:00";e=Math.round(e);var r=e%60,i=0;return r>59&&(i=Math.floor(r/60),r%=60),twoDigits(i)+":"+twoDigits(r)}function twoDigits(e){return e<10?"0"+e:e}!function(e){e("body").on("click",".play-icon",function(r){r.preventDefault();var i=e(this),t=i.closest(".audio-player");if(t.hasClass("audio-error"))return!1;var a,n=t.prev("video")[0],o=t.find(".playing-bar .curr-time"),u=t.find(".playing-bar .full-time").width(),d=t.find(".playing-bar .handle-time"),s=t.find(".duration-bar .curr-dur");!n.played||n.paused||n.ended?(n.play(),a=setInterval(function(){if(n.ended)clearInterval(a),i.addClass("pause"),o.css("width",u),d.css("left",u),s.text(convertTime(n.duration));else{var e=n.currentTime/n.duration;o.width(e*u),d.css("left",e*u),s.text(convertTime(n.currentTime))}},100),i.removeClass("pause")):(n.pause(),clearInterval(a),i.addClass("pause"))}),e("body").on("click",".playing-bar .full-time",function(r){r.preventDefault();var i=e(this),t=i.closest(".audio-player");if(t.hasClass("audio-error"))return!1;var a=r.pageX-i.offset().left,n=i.find(".curr-time"),o=i.find(".handle-time"),u=i.closest(".audio-player").find(".curr-dur"),d=i.closest(".audio-player").prev("video")[0];d.currentTime=a/i.width()*d.duration,n.width(a),o.css("left",a),u.text(convertTime(d.currentTime))}),e("body").on("click",".volume-icon",function(r){r.preventDefault();var i=e(this),t=i.closest(".audio-player");if(t.hasClass("audio-error"))return!1;var a=t.prev("video")[0];a.muted?(a.muted=!1,i.removeClass("mute")):(a.muted=!0,i.addClass("mute"))}),e(document).ready(function(){initAudioPlayer()})}(jQuery);