function checkEmployeeArr(e){if(e.is(":checked"))checkEmployee.push(e.val());else for(var t=checkEmployee.length-1;t>=0;t--)checkEmployee[t]===e.val()&&checkEmployee.splice(t,1);return checkEmployee}function checkAll(){var e=0,t=0;$(".check-item").each(function(){t++,$(this).is(":checked")?e++:($(".check-all").prop("checked",!1),$(".check-all").removeAttr("checked"))}),t===e&&$(".check-all").prop("checked",!0)}function getData(e){var t=$("#team_id").val(),c=$("#input-name").val(),i=$("#input-email").val();$.ajax({url:e,type:"get",datatype:"html",data:{team:t,name:c,email:i,checkArr:checkEmployee}}).done(function(e){var t=e.indexOf('<div class="row table-responsive">'),c=e.indexOf('<div class="end-seach-employee">'),i=e.slice(t,c)+"<script>$('.check-item').click(function(){$.ajax({url:urlEmployee,type:'post',data:{_token: token,type:'check',checkArr:checkEmployeeArr($(this))},dataType: 'json',success:function(check){$('.select-employee').html(check.content);checkAll();},});});</script>";$(".search-employee").empty().html(i)}).fail(function(e,t,c){})}function searchEmployee(){var e=$("#team_id").val(),t=$("#input-name").val(),c=$("#input-email").val();$.ajax({url:urlList,type:"get",data:{_token:token,team:e,name:t,email:c,checkArr:checkEmployee},dataType:"json",success:function(e){var t=e.content.indexOf('<div class="row table-responsive">'),c=e.content.indexOf('<div class="end-seach-employee">'),i=e.content.slice(t,c)+"<script>$('.check-item').click(function(){$.ajax({url:urlEmployee,type:'post',data:{_token: token,type:'check',checkArr:checkEmployeeArr($(this))},dataType: 'json',success:function(check){$('.select-employee').html(check.content);checkAll();},});});</script>";$(".search-employee").html(i)}})}!function(e){e(document).on("change","#test",function(t){var c=e("#test").val();0!==c&&e.ajax({url:urlOption,type:"post",data:{_token:token,test:c},dataType:"json",success:function(t){checkDivision=[],checkEmployee=[],t.error?(e("#multi_times").prop("checked",!1),e("#multi_times").removeAttr("checked"),e("#time_from").val(""),e("#time_to").val(""),e("#division").val(""),e("#division").multiselect("refresh"),e(".select-division").html(""),searchEmployee(),e(".select-employee").html("")):(0===t.multi_times?(e("#multi_times").prop("checked",!1),e("#multi_times").removeAttr("checked")):e("#multi_times").prop("checked",!0),e("#time_from").val(t.time_from),e("#time_to").val(t.time_to),checkDivision=t.checkDivision,e("#division").val(checkDivision),e("#division").multiselect("refresh"),e(".select-division").html(t.division),checkEmployee=t.checkEmployee,searchEmployee(),e(".select-employee").html(t.employee))}})}),e("#time_from").datetimepicker({format:"YYYY-MM-DD HH:mm:ss",minDate:new Date}),e("#time_to").datetimepicker({format:"YYYY-MM-DD HH:mm:ss",minDate:new Date}),e("#time_from").on("dp.change",function(t){var c=e(this).parent().parent().find("#time_to");e(this).parent().find("label").remove(),c.parent().find("label").remove(),""!==c.val()&&e(this).val()>c.val()&&e(this).after('<label id="name-error" class="error" for="name">'+timeFromValidate+"</label>")}),e("#time_to").on("dp.change",function(t){var c=e(this).parent().parent().find("#time_from");e(this).parent().find("label").remove(),c.parent().find("label").remove(),e(this).val()<c.val()&&e(this).after('<label id="name-error" class="error" for="name">'+timeToValidate+"</label>")}),e(document).on("change","#division",function(t){var c=e("#division").val();e.ajax({url:urlOption,type:"post",data:{_token:token,division:c},dataType:"json",success:function(t){e(".select-division").html(t.division)}})}),e("#input-name").keyup(function(e){13===e.keyCode&&searchEmployee()}),e("#input-email").keyup(function(e){13===e.keyCode&&searchEmployee()}),e(document).on("click",".btn-reset-filter-emp",function(t){e("#team_id").multiselect("clearSelection"),e("#input-name").val(""),e("#input-email").val(""),searchEmployee()}),e(document).on("click",".btn-search-filter-emp",function(e){searchEmployee()}),e(".check-all").click(function(){var t;e(this).is(":checked")?e(".check-item").each(function(){e(this).prop("checked",!0),t=checkEmployeeArr(e(this))}):e(".check-item").each(function(){e(this).prop("checked",!1),e(this).removeAttr("checked"),t=checkEmployeeArr(e(this))}),e.ajax({url:urlEmployee,type:"post",data:{_token:token,checkArr:t},dataType:"json",success:function(t){e(".select-employee").html(t.content)}})}),e(".check-item").click(function(){e.ajax({url:urlEmployee,type:"post",data:{_token:token,checkArr:checkEmployeeArr(e(this))},dataType:"json",success:function(t){e(".select-employee").html(t.content),checkAll()}})}),e(window).on("hashchange",function(){if(window.location.hash){var e=window.location.hash.replace("#","");if(e===Number.NaN||e<=0)return!1;getData(e)}}),e(document).ready(function(){e(document).on("click",".pagination a",function(t){t.preventDefault(),e("li").removeClass("active"),e(this).parent("li").addClass("active");var c=e(this).attr("href");getData(c)})}),e(document).on("click","#btn-save",function(t){var c=[];e(".check-employee").each(function(){c.push(e(this).val())});var i=0;e("#multi_times").is(":checked")&&(i=1),dataSave={_token:token,data:{test_id:e("#test").val(),multi_times:i,time_from:e("#time_from").val(),time_to:e("#time_to").val(),team_id:e("#division").val(),employee_id:c}},e.ajax({url:urlSave,type:"post",data:dataSave,dataType:"json",success:function(t){if(t.success&&(e("#modal-success-notification .text-default").html(t.message),e("#modal-success-notification").modal("show")),t.error)if(2===t.error){if(t.message&&!confirm(t.message))return;dataComfirm={_token:token,data:t.data,ok:"ok"},e.ajax({url:urlSave,type:"post",data:dataComfirm,dataType:"json",success:function(t){t.success&&(e("#modal-success-notification .text-default").html(t.message),e("#modal-success-notification").modal("show"))}})}else e("#modal-warning-notification .text-default").html(t.message),e("#modal-warning-notification").modal("show")}})})}(jQuery);